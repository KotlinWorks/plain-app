import{b as tt,u as et,_ as ot,a as st}from"./list-2a0eb093.js";import{_ as at}from"./FieldId-d3cd765c.js";import{_ as nt}from"./Multiselect-22bdf84a.js";import{_ as lt}from"./Dropdown.vuevuetypescriptsetuptruelang-615229ff.js";import{_ as ct}from"./Breadcrumb-49d3fe3b.js";import{d as it,p as ut,r as p,u as rt,A as dt,n as pt,B as _t,C as mt,aL as ht,D as ft,t as vt,aM as gt,G as bt,H as kt,I as yt,o as c,c as r,b as t,e as _,w as b,f as a,v as $t,J as C,K as Ct,L as wt,g as n,M as Q,N as Vt,F as w,y as U,x as Tt,P as L,k as x,Q as At,z as F,R as K,aN as N}from"./index-03d179e2.js";import{b as It,a as St}from"./search-fae66e3e.js";import{n as Dt}from"./list-6498ebd9.js";import{u as qt,a as Bt,b as Mt}from"./tags-01c5b779.js";import{t as Qt}from"./truncate-ff6d303a.js";import"./VModal.vuevuetypescriptsetuptruelang-33c2fc8e.js";import"./baseIndexOf-70b929c6.js";import"./vee-validate.esm-16aa8390.js";import"./stringToArray-b3030e27.js";import"./toInteger-dbfb180b.js";const Ut={class:"v-toolbar"},Lt={class:"right-actions"},xt=["onClick"],Ft={class:"row mb-3"},Kt={class:"col-md-3 col-form-label"},Nt={class:"col-md-9"},Rt=["onKeyup"],zt={class:"row mb-3"},Gt={class:"col-md-3 col-form-label"},Pt={class:"col-md-9"},Ht={class:"actions"},Et=["onClick"],Jt={class:"table"},jt=t("th",null,"ID",-1),Ot=["onClick"],Wt=["onUpdate:modelValue"],Xt=["onClick"],Yt={class:"badge"},Zt={class:"nowrap"},te={class:"nowrap"},ee={key:0},oe={colspan:"6"},se={class:"no-data-placeholder"},ye=it({__name:"AIChatsView",setup(ae){var B,M;const V=ut(),l=p([]),{t:m}=rt(),i=dt({text:"",tags:[]}),h="AI_CHAT",T=pt().query,f=p(parseInt(((B=T.page)==null?void 0:B.toString())??"1")),v=50,g=p(0),u=p(_t(((M=T.q)==null?void 0:M.toString())??"")),A=p(""),{tags:k}=qt(h,u,i,async o=>{o.push({name:"parent_id",op:"",value:""}),A.value=It(o),await mt(),E()}),{addToTags:R}=Bt(h,l,k),{removeFromTags:z}=Mt(h,l,k),{deleteItems:G}=tt(ht,()=>{S()},l),P=[{text:m("add_to_tags"),click:R},{text:m("remove_from_tags"),click:z},{text:m("delete"),click:G}],{selectAll:y,toggleSelect:I}=et(l),{loading:H,load:E,refetch:S}=ft({handle:(o,s)=>{s?vt(m(s),"error"):o&&(l.value=o.aiChats.map($=>({...$,checked:!1})),g.value=o.aiChatCount)},document:gt,variables:()=>({offset:(f.value-1)*v,limit:v,query:A.value}),appApi:!0});bt(f,o=>{F(V,`/aichats?page=${o}&q=${K(u.value)}`)});function D(){u.value=St(i),q()}function q(){F(V,`/aichats?q=${K(u.value)}`)}kt(()=>{yt.on("refetch_by_tag_type",o=>{o===h&&S()})});function J(o){N(`/aichats/${o.id}`)}function j(){N("/aichats/create")}return(o,s)=>{const $=ct,O=lt,W=nt,X=ot,Y=at,Z=st;return c(),r(w,null,[t("div",Ut,[_($,{current:()=>`${o.$t("page_title.aichats")} (${g.value})`},null,8,["current"]),t("div",Lt,[t("button",{class:"btn btn-action",type:"button",onClick:b(j,["prevent"])},a(o.$t("new_chat")),9,xt),_(O,{title:o.$t("actions"),items:P},null,8,["title"]),_(X,{modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=e=>u.value=e),search:q},{filters:$t(()=>[t("div",Ft,[t("label",Kt,a(o.$t("keywords")),1),t("div",Nt,[C(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>i.text=e),class:"form-control",onKeyup:wt(D,["enter"])},null,40,Rt),[[Ct,i.text]])])]),t("div",zt,[t("label",Gt,a(o.$t("tags")),1),t("div",Pt,[_(W,{modelValue:i.tags,"onUpdate:modelValue":s[1]||(s[1]=e=>i.tags=e),label:"name","track-by":"id",options:n(k)},null,8,["modelValue","options"])])]),t("div",Ht,[t("button",{type:"button",class:"btn",onClick:b(D,["stop"])},a(o.$t("search")),9,Et)])]),_:1},8,["modelValue"])])]),t("table",Jt,[t("thead",null,[t("tr",null,[t("th",null,[C(t("input",{class:"form-check-input",type:"checkbox",onChange:s[3]||(s[3]=(...e)=>n(I)&&n(I)(...e)),"onUpdate:modelValue":s[4]||(s[4]=e=>Vt(y)?y.value=e:null)},null,544),[[Q,n(y)]])]),jt,t("th",null,a(o.$t("content")),1),t("th",null,a(o.$t("tags")),1),t("th",null,a(o.$t("updated_at")),1),t("th",null,a(o.$t("created_at")),1)])]),t("tbody",null,[(c(!0),r(w,null,U(l.value,e=>(c(),r("tr",{key:e.id,class:Tt({checked:e.checked}),onClick:b(d=>e.checked=!e.checked,["stop"])},[t("td",null,[C(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>e.checked=d},null,8,Wt),[[Q,e.checked]])]),t("td",null,[_(Y,{id:e.id,raw:e},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:b(d=>J(e),["stop"])},a(n(Qt)(e.content,{length:200,omission:""})),9,Xt)]),t("td",null,[(c(!0),r(w,null,U(e.tags,d=>(c(),r("span",Yt,a(d.name),1))),256))]),t("td",Zt,a(n(L)(e.updatedAt)),1),t("td",te,a(n(L)(e.createdAt)),1)],10,Ot))),128))]),l.value.length?x("",!0):(c(),r("tfoot",ee,[t("tr",null,[t("td",oe,[t("div",se,a(o.$t(n(Dt)(n(H)))),1)])])]))]),g.value>v?(c(),At(Z,{key:0,modelValue:f.value,"onUpdate:modelValue":s[5]||(s[5]=e=>f.value=e),total:g.value,limit:v},null,8,["modelValue","total"])):x("",!0)],64)}}});export{ye as default};

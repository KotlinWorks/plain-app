import{b as ot,u as st,_ as nt,a as at}from"./list-99d4982b.js";import{_ as lt}from"./FieldId-e37ba71f.js";import{_ as ct}from"./Multiselect-346d4eab.js";import{_ as it,a as ut}from"./label-outline-rounded-657ec04e.js";import{_ as dt}from"./delete-outline-rounded-182ee2de.js";import{_ as rt}from"./Breadcrumb-731a6814.js";import{d as _t,p as pt,r as m,u as mt,B as ht,n as bt,C as ft,D as vt,E as gt,aT as kt,G as yt,H as Ct,t as $t,aU as Vt,J as wt,K as Tt,L as At,o as c,c as i,b as t,e as u,g as n,F as g,w as d,k as $,f as a,x as St,M as V,N as Ut,O as Dt,P as K,Q as qt,z as L,y as Bt,S as N,T as It,A as z,U as G,V as Qt,aV as P}from"./index-66bea2e9.js";import{n as Mt}from"./list-6498ebd9.js";import{u as Ft,a as Kt,b as Lt}from"./tags-4fd68896.js";import{t as Nt}from"./truncate-2f04ae7b.js";import"./VModal.vuevuetypescriptsetuptruelang-091ab08d.js";import"./vee-validate.esm-18b68f3d.js";import"./stringToArray-243d75d5.js";const zt={class:"v-toolbar"},Gt={class:"right-actions"},Pt=["title"],Rt=["title"],Et=["title"],Ht=["onClick"],Jt={class:"row mb-3"},Ot={class:"col-md-3 col-form-label"},jt={class:"col-md-9"},xt=["onKeyup"],Wt={class:"row mb-3"},Xt={class:"col-md-3 col-form-label"},Yt={class:"col-md-9"},Zt={class:"actions"},te=["onClick"],ee={class:"table"},oe=t("th",null,"ID",-1),se=["onClick"],ne=["onUpdate:modelValue"],ae=["onClick"],le={class:"badge"},ce={class:"nowrap"},ie={class:"nowrap"},ue={key:0},de={colspan:"6"},re={class:"no-data-placeholder"},Ae=_t({__name:"AIChatsView",setup(_e){var M,F;const w=pt(),l=m([]),{t:R}=mt(),r=ht({text:"",tags:[]}),h="AI_CHAT",T=bt().query,b=m(parseInt(((M=T.page)==null?void 0:M.toString())??"1")),f=50,v=m(0),_=m(ft(((F=T.q)==null?void 0:F.toString())??"")),A=m(""),{tags:k}=Ft(h,_,r,async o=>{o.push({name:"parent_id",op:"",value:""}),A.value=vt(o),await gt(),J()}),{addToTags:S}=Kt(h,l,k),{removeFromTags:U}=Lt(h,l,k),{deleteItems:D}=ot(kt,()=>{B()},l),E=yt(()=>l.value.some(o=>o.checked)),{selectAll:y,toggleSelect:q}=st(l),{loading:H,load:J,refetch:B}=Ct({handle:(o,s)=>{s?$t(R(s),"error"):o&&(l.value=o.aiChats.map(C=>({...C,checked:!1})),v.value=o.aiChatCount)},document:Vt,variables:()=>({offset:(b.value-1)*f,limit:f,query:A.value}),appApi:!0});wt(b,o=>{z(w,`/aichats?page=${o}&q=${G(_.value)}`)});function I(){_.value=Qt(r),Q()}function Q(){z(w,`/aichats?q=${G(_.value)}`)}Tt(()=>{At.on("refetch_by_tag_type",o=>{o===h&&B()})});function O(o){P(`/aichats/${o.id}`)}function j(){P("/aichats/create")}return(o,s)=>{const C=rt,x=dt,W=it,X=ut,Y=ct,Z=nt,tt=lt,et=at;return c(),i(g,null,[t("div",zt,[u(C,{current:()=>`${o.$t("page_title.aichats")} (${v.value})`},null,8,["current"]),t("div",Gt,[n(E)?(c(),i(g,{key:0},[t("button",{type:"button",class:"btn btn-action",onClick:s[0]||(s[0]=d((...e)=>n(D)&&n(D)(...e),["stop"])),title:o.$t("delete")},[u(x,{class:"bi"})],8,Pt),t("button",{type:"button",class:"btn btn-action",onClick:s[1]||(s[1]=d((...e)=>n(S)&&n(S)(...e),["stop"])),title:o.$t("add_to_tags")},[u(W,{class:"bi"})],8,Rt),t("button",{type:"button",class:"btn btn-action",onClick:s[2]||(s[2]=d((...e)=>n(U)&&n(U)(...e),["stop"])),title:o.$t("remove_from_tags")},[u(X,{class:"bi"})],8,Et)],64)):$("",!0),t("button",{class:"btn btn-action",type:"button",onClick:d(j,["prevent"])},a(o.$t("new_chat")),9,Ht),u(Z,{modelValue:_.value,"onUpdate:modelValue":s[5]||(s[5]=e=>_.value=e),search:Q},{filters:St(()=>[t("div",Jt,[t("label",Ot,a(o.$t("keywords")),1),t("div",jt,[V(t("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=e=>r.text=e),class:"form-control",onKeyup:Dt(I,["enter"])},null,40,xt),[[Ut,r.text]])])]),t("div",Wt,[t("label",Xt,a(o.$t("tags")),1),t("div",Yt,[u(Y,{modelValue:r.tags,"onUpdate:modelValue":s[4]||(s[4]=e=>r.tags=e),label:"name","track-by":"id",options:n(k)},null,8,["modelValue","options"])])]),t("div",Zt,[t("button",{type:"button",class:"btn",onClick:d(I,["stop"])},a(o.$t("search")),9,te)])]),_:1},8,["modelValue"])])]),t("table",ee,[t("thead",null,[t("tr",null,[t("th",null,[V(t("input",{class:"form-check-input",type:"checkbox",onChange:s[6]||(s[6]=(...e)=>n(q)&&n(q)(...e)),"onUpdate:modelValue":s[7]||(s[7]=e=>qt(y)?y.value=e:null)},null,544),[[K,n(y)]])]),oe,t("th",null,a(o.$t("content")),1),t("th",null,a(o.$t("tags")),1),t("th",null,a(o.$t("updated_at")),1),t("th",null,a(o.$t("created_at")),1)])]),t("tbody",null,[(c(!0),i(g,null,L(l.value,e=>(c(),i("tr",{key:e.id,class:Bt({checked:e.checked}),onClick:d(p=>e.checked=!e.checked,["stop"])},[t("td",null,[V(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>e.checked=p},null,8,ne),[[K,e.checked]])]),t("td",null,[u(tt,{id:e.id,raw:e},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:d(p=>O(e),["stop"])},a(n(Nt)(e.content,{length:200,omission:""})),9,ae)]),t("td",null,[(c(!0),i(g,null,L(e.tags,p=>(c(),i("span",le,a(p.name),1))),256))]),t("td",ce,a(n(N)(e.updatedAt)),1),t("td",ie,a(n(N)(e.createdAt)),1)],10,se))),128))]),l.value.length?$("",!0):(c(),i("tfoot",ue,[t("tr",null,[t("td",de,[t("div",re,a(o.$t(n(Mt)(n(H)))),1)])])]))]),v.value>f?(c(),It(et,{key:0,modelValue:b.value,"onUpdate:modelValue":s[8]||(s[8]=e=>b.value=e),total:v.value,limit:f},null,8,["modelValue","total"])):$("",!0)],64)}}});export{Ae as default};

import{a as W,_ as X}from"./TagFilter.vuevuetypescriptsetuptruelang-c1d9aeea.js";import{d as G,r as g,a2 as F,c9 as Z,ah as ee,E as te,ai as w,o as _,e as v,f as t,j as p,M as I,N as oe,k as e,aj as ne,ak as se,u as ae,a as ie,p as le,q as de,ca as re,i as ue,V as A,cb as ce,t as L,v as pe,L as me,x as f,y as D,cc as fe,cd as _e,ce as ve,cf as he,g as be,F as T,A as V,w as q,z as Q,bD as S,D as ke,n as E,S as xe,cg as ye,a7 as Ce}from"./index-5e3ce573.js";import{g as R,M as ge}from"./splitpanes.es-97795b24.js";import{E as Fe}from"./EditValueModal-e04a5760.js";import{c as $e}from"./index-db3fd04a.js";import{u as Me,a as we}from"./vee-validate.esm-e8a787ff.js";const Ae={slot:"headline"},De={slot:"content"},Ee={class:"form-label"},Ne={class:"form-row"},Le=["label","error","error-text"],Te={slot:"actions"},Ve=["disabled"],qe=G({__name:"FeedModal",props:{data:{type:Object}},setup($){var x;const s=$,{handleSubmit:h}=Me(),b=g(),{mutate:M,loading:k,onDone:m}=F({document:Z,appApi:!0}),{value:d,errorMessage:c}=we("inputValue",ee().required());d.value=((x=s.data)==null?void 0:x.name)??"",(async()=>{var a;await te(),(a=b.value)==null||a.focus()})();const r=h(()=>{var a;M({id:(a=s.data)==null?void 0:a.id,name:d.value})});return m(()=>{w()}),(a,i)=>{var C;return _(),v("md-dialog",null,[t("div",Ae,p(a.$t("update_subscription")),1),t("div",De,[t("div",Ee,p((C=$.data)==null?void 0:C.url),1),t("div",Ne,[I(t("md-outlined-text-field",{ref_key:"input",ref:b,class:"form-control",label:a.$t("name"),error:e(c),"error-text":e(c)?a.$t(e(c)):"","onUpdate:modelValue":i[0]||(i[0]=l=>ne(d)?d.value=l:null),onKeyup:i[1]||(i[1]=se((...l)=>e(r)&&e(r)(...l),["enter"]))},null,40,Le),[[oe,e(d)]])])]),t("div",Te,[t("md-outlined-button",{value:"cancel",onClick:i[2]||(i[2]=(...l)=>e(w)&&e(w)(...l))},p(a.$t("cancel")),1),t("md-filled-button",{value:"save",disabled:e(k),onClick:i[3]||(i[3]=(...l)=>e(r)&&e(r)(...l)),autofocus:""},p(a.$t("save")),9,Ve)])])}}}),Qe={class:"page-container"},Se={class:"sidebar"},Re={class:"nav-title"},Ge={style:{position:"relative"}},Ie=["open"],ze=["headline","onClick"],Be=t("md-ripple",null,null,-1),Oe={class:"nav"},je=["onClick"],Pe=["onClick","onContextmenu"],Ke={class:"main"},Ue={name:"FeedsRoot",inheritAttrs:!1,customOptions:{}},et=G({...Ue,setup($){const{t:s}=ae(),h=ie(),b=g([]),M=[{text:s("add_subscription"),click:i},{text:s("import_opml_file"),click:O},{text:s("export_opml_file"),click:j}],k=g(!1),m=le(),d=de(m.query),c=re(m.query),r=g(),{refetch:x}=ue({handle:(o,n)=>{n?L(s(n),"error"):o&&(b.value=o.feeds)},document:fe,appApi:!0});function a(o){const n=o.target.files;if(!n)return;const y=new FileReader;y.addEventListener("load",()=>{z({content:y.result})},!1),y.readAsText(n[0])}function i(){A(Fe,{title:s("add_subscription"),placeholder:s("rss_url"),mutation:()=>F({document:_e,options:{update:()=>{x()}},appApi:!0}),getVariables:o=>({url:o})})}const{mutate:C,onDone:l}=F({document:ve,appApi:!0});l(o=>{ce(o.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:z,onDone:B}=F({document:he,appApi:!0});B(()=>{L(s("imported")),x()});function O(){r.value.value="",r.value.click()}function j(){C()}function P(o){const n=ke([{name:"feed",op:"",value:S(o.name)}]);E(h,`/feeds?q=${xe(n)}`)}function K(o,n){o.preventDefault(),$e({x:o.x,y:o.y,items:[{label:s("edit"),onClick:()=>{A(qe,{data:n})}},{label:s("delete"),onClick:()=>{A(Ce,{id:n.id,name:n.name,gql:ye,appApi:!0,typeName:"Feed",done:()=>{E(h,"/feeds")}})}}]})}function U(){E(h,"/feeds")}return(o,n)=>{const y=W,Y=X,H=pe("router-view"),J=me("tooltip");return _(),v("div",Qe,[f(e(ge),null,{default:D(()=>[f(e(R),{size:"20","min-size":"10"},{default:D(()=>[t("div",Se,[t("h2",Re,[be(p(o.$t("page_title.feeds"))+" ",1),t("div",Ge,[t("md-menu",{anchor:"add-feed-ref","menu-corner":"START_START","anchor-corner":"END_END",fixed:"true","stay-open-on-focusout":"",quick:"",open:k.value,onClosed:n[0]||(n[0]=()=>k.value=!1)},[(_(),v(T,null,V(M,u=>t("md-menu-item",{headline:u.text,onClick:u.click},null,8,ze)),64))],40,Ie),I((_(),v("button",{class:"icon-button",id:"add-feed-ref",onClick:n[1]||(n[1]=()=>k.value=!0)},[Be,f(y)])),[[J,e(s)("add_subscription")]])])]),t("ul",Oe,[t("li",{onClick:q(U,["prevent"]),class:Q({active:e(m).path==="/feeds"&&!e(d)&&!e(c)})},p(o.$t("all")),11,je),(_(!0),v(T,null,V(b.value,u=>(_(),v("li",{onClick:q(N=>P(u),["prevent"]),onContextmenu:N=>K(N,u),class:Q({active:e(m).params.feedId===u.id||e(c)&&e(S)(u.name)===e(c)})},p(u.name),43,Pe))),256))]),f(Y,{type:"FEED_ENTRY",selected:e(d)},null,8,["selected"])])]),_:1}),f(e(R),null,{default:D(()=>[t("div",Ke,[f(H)])]),_:1})]),_:1}),t("input",{ref_key:"fileInput",ref:r,style:{display:"none"},accept:".xml",type:"file",onChange:a},null,544)])}}});export{et as default};

import{a as J,_ as W}from"./TagFilter.vuevuetypescriptsetuptruelang-a5457e61.js";import{d as S,r as g,a3 as F,c6 as Z,ai as ee,G as te,aj as w,o as _,c as v,e as o,g as p,O as I,P as oe,j as e,ak as ne,al as ae,u as se,p as ie,n as le,q as de,c7 as re,i as ue,X as A,c8 as ce,t as D,v as pe,N as me,x as f,y as E,c9 as fe,ca as _e,cb as ve,cc as he,f as be,F as L,A as V,w as q,z as Q,bC as G,E as xe,B as N,U as ke,cd as Ce,a8 as ye}from"./index-df35a132.js";import{g as R,M as ge}from"./splitpanes.es-c959884b.js";import{E as Fe}from"./EditValueModal-46b4c4bb.js";import{c as $e}from"./index-4e369b28.js";import{u as Me,a as we}from"./vee-validate.esm-aa1410cb.js";const Ae={slot:"headline"},Ee={slot:"content"},Ne={class:"form-label"},Te={class:"form-row"},De=["label","error","error-text"],Le={slot:"actions"},Ve=["disabled"],qe=S({__name:"FeedModal",props:{data:{type:Object}},setup($){var k;const a=$,{handleSubmit:h}=Me(),b=g(),{mutate:M,loading:x,onDone:m}=F({document:Z,appApi:!0}),{value:d,errorMessage:c}=we("inputValue",ee().required());d.value=((k=a.data)==null?void 0:k.name)??"",(async()=>{var s;await te(),(s=b.value)==null||s.focus()})();const r=h(()=>{var s;M({id:(s=a.data)==null?void 0:s.id,name:d.value})});return m(()=>{w()}),(s,i)=>{var y;return _(),v("md-dialog",null,[o("div",Ae,p(s.$t("update_subscription")),1),o("div",Ee,[o("div",Ne,p((y=$.data)==null?void 0:y.url),1),o("div",Te,[I(o("md-outlined-text-field",{ref_key:"input",ref:b,class:"form-control",label:s.$t("name"),error:e(c),"error-text":e(c)?s.$t(e(c)):"","onUpdate:modelValue":i[0]||(i[0]=l=>ne(d)?d.value=l:null),onKeyup:i[1]||(i[1]=ae((...l)=>e(r)&&e(r)(...l),["enter"]))},null,40,De),[[oe,e(d)]])])]),o("div",Le,[o("md-outlined-button",{value:"cancel",onClick:i[2]||(i[2]=(...l)=>e(w)&&e(w)(...l)),autofocus:""},p(s.$t("cancel")),1),o("md-filled-button",{value:"save",disabled:e(x),onClick:i[3]||(i[3]=(...l)=>e(r)&&e(r)(...l))},p(s.$t("save")),9,Ve)])])}}}),Qe={class:"page-container"},Ge={class:"sidebar"},Re={class:"nav-title"},Se={style:{position:"relative"}},Ie=["open"],Be=["headline","onClick"],Oe={class:"nav"},ze=["onClick"],Pe=["onClick","onContextmenu"],je={class:"main"},Ke={name:"FeedsRoot",inheritAttrs:!1,customOptions:{}},Ze=S({...Ke,setup($){const{t:a}=se(),h=ie(),b=g([]),M=[{text:a("add_subscription"),click:i},{text:a("import_opml_file"),click:z},{text:a("export_opml_file"),click:P}],x=g(!1),m=le(),d=de(m.query),c=re(m.query),r=g(),{refetch:k}=ue({handle:(t,n)=>{n?D(a(n),"error"):t&&(b.value=t.feeds)},document:fe,appApi:!0});function s(t){const n=t.target.files;if(!n)return;const C=new FileReader;C.addEventListener("load",()=>{B({content:C.result})},!1),C.readAsText(n[0])}function i(){A(Fe,{title:a("add_subscription"),placeholder:a("rss_url"),mutation:()=>F({document:_e,options:{update:()=>{k()}},appApi:!0}),getVariables:t=>({url:t})})}const{mutate:y,onDone:l}=F({document:ve,appApi:!0});l(t=>{ce(t.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:B,onDone:O}=F({document:he,appApi:!0});O(()=>{D(a("imported")),k()});function z(){r.value.value="",r.value.click()}function P(){y()}function j(t){const n=xe([{name:"feed",op:"",value:G(t.name)}]);N(h,`/feeds?q=${ke(n)}`)}function K(t,n){t.preventDefault(),$e({x:t.x,y:t.y,items:[{label:a("edit"),onClick:()=>{A(qe,{data:n})}},{label:a("delete"),onClick:()=>{A(ye,{id:n.id,name:n.name,gql:Ce,appApi:!0,typeName:"Feed",done:()=>{N(h,"/feeds")}})}}]})}function U(){N(h,"/feeds")}return(t,n)=>{const C=J,X=W,Y=pe("router-view"),H=me("tooltip");return _(),v("div",Qe,[f(e(ge),null,{default:E(()=>[f(e(R),{size:"20","min-size":"10"},{default:E(()=>[o("div",Ge,[o("h2",Re,[be(p(t.$t("page_title.feeds"))+" ",1),o("div",Se,[o("md-menu",{anchor:"add-feed-ref","menu-corner":"START_START","anchor-corner":"END_END",fixed:"true","stay-open-on-focusout":"",quick:"",open:x.value,onClosed:n[0]||(n[0]=()=>x.value=!1)},[(_(),v(L,null,V(M,u=>o("md-menu-item",{headline:u.text,onClick:u.click},null,8,Be)),64))],40,Ie),I((_(),v("md-icon-button",{id:"add-feed-ref",onClick:n[1]||(n[1]=()=>x.value=!0)},[f(C)])),[[H,e(a)("add_subscription")]])])]),o("ul",Oe,[o("li",{onClick:q(U,["prevent"]),class:Q({active:e(m).path==="/feeds"&&!e(d)&&!e(c)})},p(t.$t("all")),11,ze),(_(!0),v(L,null,V(b.value,u=>(_(),v("li",{onClick:q(T=>j(u),["prevent"]),onContextmenu:T=>K(T,u),class:Q({active:e(m).params.feedId===u.id||e(c)&&e(G)(u.name)===e(c)})},p(u.name),43,Pe))),256))]),f(X,{"tag-type":"FEED_ENTRY",selected:e(d)},null,8,["selected"])])]),_:1}),f(e(R),null,{default:E(()=>[o("div",je,[f(Y)])]),_:1})]),_:1}),o("input",{ref_key:"fileInput",ref:r,style:{display:"none"},accept:".xml",type:"file",onChange:s},null,544)])}}});export{Ze as default};

import{_ as K}from"./TagFilter.vuevuetypescriptsetuptruelang-2cc23cc3.js";import{d as D,r as M,bJ as U,M as A,o as f,c as y,b as a,f as d,w as q,F as Q,z as I,ad as B,Y as C,bZ as Y,ab as J,E as Z,ac as H,T as W,x as w,Q as X,O as ee,g as t,N as te,u as se,p as O,n as R,i as ae,t as T,b_ as ne,a0 as N,b$ as oe,c0 as ie,c1 as le,c2 as re,j as ce,e as h,y as z,bt as V,D as de,A as S,U as ue,c3 as pe,q as me,c4 as _e,v as fe}from"./index-66bea2e9.js";import{_ as ve}from"./EditValueModal.vuevuetypescriptsetuptruelang-8fdf5735.js";import{c as be}from"./index-64929f64.js";import{_ as he}from"./DeleteConfirm.vuevuetypescriptsetuptruelang-f7245844.js";import{_ as ye}from"./VModal.vuevuetypescriptsetuptruelang-091ab08d.js";import{u as $e,a as ke}from"./vee-validate.esm-18b68f3d.js";import{g as G,M as xe}from"./splitpanes.es-57df8e4f.js";const ge={class:"dropdown"},Fe={class:"dropdown-menu"},we=["onClick"],Ce=D({__name:"Dropdown",props:{title:{type:String,required:!0},items:{type:Array,required:!0,default:()=>[]}},setup(r){const e=M(!1);return(v,i)=>{const l=U("click-away");return A((f(),y("div",ge,[a("button",{class:"btn dropdown-toggle",type:"button",onClick:i[0]||(i[0]=q(()=>e.value=!e.value,["prevent"]))},d(r.title),1),A(a("ul",Fe,[(f(!0),y(Q,null,I(r.items,(u,p)=>(f(),y("li",{key:p},[a("a",{class:"dropdown-item",href:"#",onClick:q(()=>{e.value=!1,u.click()},["prevent"])},d(u.text),9,we)]))),128))],512),[[B,e.value]])])),[[l,()=>e.value=!1]])}}}),Me={class:"mb-4"},Ae=["placeholder"],qe=["disabled"],De=D({__name:"FeedModal",props:{data:{type:Object}},setup(r){var $;const e=r,{handleSubmit:v}=$e(),i=M(),{mutate:l,loading:u,onDone:p}=C({document:Y,appApi:!0}),{value:c,errorMessage:b}=ke("inputValue",J().required());c.value=(($=e.data)==null?void 0:$.name)??"",(async()=>{var n;await Z(),(n=i.value)==null||n.focus()})();const m=v(()=>{var n;l({id:(n=e.data)==null?void 0:n.id,name:c.value})});return p(()=>{H()}),(n,_)=>{const L=ye;return f(),W(L,{title:n.$t("update_subscription")},{body:w(()=>{var k;return[a("div",Me,d((k=r.data)==null?void 0:k.url),1),a("div",null,[A(a("input",{ref_key:"input",ref:i,type:"text",placeholder:n.$t("name"),class:"form-control","onUpdate:modelValue":_[0]||(_[0]=x=>X(c)?c.value=x:null),onKeyup:_[1]||(_[1]=ee((...x)=>t(m)&&t(m)(...x),["enter"]))},null,40,Ae),[[te,t(c)]]),A(a("div",{class:"invalid-feedback"},d(t(b)?n.$t(t(b)):""),513),[[B,t(b)]])])]}),action:w(()=>[a("button",{type:"button",disabled:t(u),class:"btn",onClick:_[2]||(_[2]=(...k)=>t(m)&&t(m)(...k))},d(n.$t("save")),9,qe)]),_:1},8,["title"])}}}),Le={class:"nav-title mt-4"},Ne={class:"nav"},Qe=["onClick","onContextmenu"],Se=D({__name:"FeedFilter",props:{selected:{type:String,required:!0}},setup(r){const{t:e}=se(),v=O(),i=M([]),l=M(),u=R(),p=[{text:e("add_subscription"),click:m},{text:e("import_opml_file"),click:k},{text:e("export_opml_file"),click:x}],{refetch:c}=ae({handle:(s,o)=>{o?T(e(o),"error"):s&&(i.value=s.feeds)},document:ne,appApi:!0});function b(s){const o=s.target.files;if(!o)return;const g=new FileReader;g.addEventListener("load",()=>{_({content:g.result})},!1),g.readAsText(o[0])}function m(){N(ve,{title:e("add_subscription"),placeholder:e("rss_url"),mutation:()=>C({document:oe,options:{update:()=>{c()}},appApi:!0}),getVariables:s=>({url:s})})}const{mutate:$,onDone:n}=C({document:ie,appApi:!0});n(s=>{le(s.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:_,onDone:L}=C({document:re,appApi:!0});L(()=>{T(e("imported")),c()});function k(){l.value.value="",l.value.click()}function x(){$()}function P(s){const o=de([{name:"feed",op:"",value:V(s.name)}]);S(v,`/feeds?q=${ue(o)}`)}function j(s,o){s.preventDefault(),be({x:s.x,y:s.y,items:[{label:e("edit"),onClick:()=>{N(De,{data:o})}},{label:e("delete"),onClick:()=>{N(he,{id:o.id,name:o.name,gql:pe,appApi:!0,typeName:"Feed",done:()=>{S(v,"/feeds")}})}}]})}return(s,o)=>{const g=Ce;return f(),y(Q,null,[a("h2",Le,[ce(d(s.$t("subscriptions"))+" ",1),h(g,{class:"dropdown-sm",title:s.$t("add"),items:p},null,8,["title"])]),a("ul",Ne,[(f(!0),y(Q,null,I(i.value,F=>(f(),y("li",{onClick:q(E=>P(F),["prevent"]),onContextmenu:E=>j(E,F),class:z({active:t(u).params.feedId===F.id||r.selected&&t(V)(F.name)===r.selected})},d(F.name),43,Qe))),256))]),a("input",{ref_key:"fileInput",ref:l,style:{display:"none"},accept:".xml",type:"file",onChange:b},null,544)],64)}}}),Ee={class:"page-container container-fluid"},Te={class:"sidebar"},Ve={class:"nav-title"},Ge={class:"nav"},Ie=["onClick"],Be={class:"main"},Oe={name:"FeedsRoot",inheritAttrs:!1,customOptions:{}},Ze=D({...Oe,setup(r){const e=R(),v=O(),i=me(e.query),l=_e(e.query);function u(){S(v,"/feeds")}return(p,c)=>{const b=Se,m=K,$=fe("router-view");return f(),y("div",Ee,[h(t(xe),null,{default:w(()=>[h(t(G),{size:"20"},{default:w(()=>[a("div",Te,[a("h2",Ve,d(p.$t("page_title.feeds")),1),a("ul",Ge,[a("li",{onClick:q(u,["prevent"]),class:z({active:t(e).path==="/feeds"&&!t(i)&&!t(l)})},d(p.$t("all")),11,Ie)]),h(b,{selected:t(l)},null,8,["selected"]),h(m,{"tag-type":"FEED_ENTRY",selected:t(i)},null,8,["selected"])])]),_:1}),h(t(G),null,{default:w(()=>[a("div",Be,[h($)])]),_:1})]),_:1})])}}});export{Ze as default};

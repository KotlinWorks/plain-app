import{a as ae,_ as le}from"./TagFilter.vuevuetypescriptsetuptruelang-265e0273.js";import{d as I,r as y,i as D,ca as ie,an as P,U,ao as V,o as C,c as g,a as t,t as i,m as N,v as j,j as e,n as H,ap as J,h as q,_ as de,cb as ce,u as re,e as ue,D as pe,E as _e,cc as fe,g as me,cd as ve,x as T,G as he,R as $e,p as w,H as L,ce as be,cf as ke,cg as Ce,F as G,J as S,l as B,I as z,bC as K,a2 as R,T as ge,C as E,W as ye,aI as Fe,ch as xe,ac as we}from"./index-5e30f9d9.js";import{g as O,M as Me}from"./splitpanes.es-a3613159.js";import{u as W,a as Y}from"./vee-validate.esm-b94340bf.js";import"./EditValueModal-ec290435.js";const Ae={slot:"headline"},Ve={slot:"content"},De={class:"form-row"},Le=["label","error","error-text"],Re={class:"form-row"},Ee={class:"form-check-label"},Ie=["checked"],Ne={slot:"actions"},qe=["disabled"],Qe=I({__name:"AddFeedModal",props:{done:{type:Function}},setup(M){const d=M,{handleSubmit:$}=W(),f=y(),c=y(!1);function b(o){c.value=o.target.checked}const{mutate:m,loading:F,onDone:k}=D({document:ie,appApi:!0}),{value:l,resetField:v,errorMessage:r}=Y("inputValue",P().required());v();function x(){V()}(async()=>{var o;await U(),(o=f.value)==null||o.focus()})();const p=$(()=>{m({url:l.value??"",fetchContent:c.value})});return k(()=>{var o;(o=d.done)==null||o.call(this),V()}),(o,n)=>(C(),g("md-dialog",null,[t("div",Ae,i(o.$t("add_subscription")),1),t("div",Ve,[t("div",De,[N(t("md-outlined-text-field",{ref_key:"inputRef",ref:f,label:o.$t("rss_url"),"onUpdate:modelValue":n[0]||(n[0]=u=>H(l)?l.value=u:null),onKeyup:n[1]||(n[1]=J((...u)=>e(p)&&e(p)(...u),["enter"])),error:e(r),"error-text":e(r)?o.$t(e(r)):""},null,40,Le),[[j,e(l)]])]),t("div",Re,[t("label",Ee,[t("md-checkbox",{"touch-target":"wrapper",onChange:b,checked:c.value},null,40,Ie),q(" "+i(o.$t("fetch_content_automatically")),1)])])]),t("div",Ne,[t("md-outlined-button",{value:"cancel",onClick:x},i(o.$t("cancel")),1),t("md-filled-button",{value:"save",disabled:e(F),onClick:n[2]||(n[2]=(...u)=>e(p)&&e(p)(...u)),autofocus:""},i(o.$t("save")),9,qe)])]))}});const Te=de(Qe,[["__scopeId","data-v-24d21569"]]),Ge={slot:"headline"},Se={slot:"content"},Be={class:"form-label"},ze={class:"form-row"},Ke=["label","error","error-text"],Oe={class:"form-row"},Pe={class:"form-check-label"},Ue=["checked"],je={slot:"actions"},He=["disabled"],Je=I({__name:"FeedModal",props:{data:{type:Object}},setup(M){var x,p;const d=M,{handleSubmit:$}=W(),f=y(),c=y(!1);function b(o){c.value=o.target.checked}const{mutate:m,loading:F,onDone:k}=D({document:ce,appApi:!0}),{value:l,errorMessage:v}=Y("inputValue",P().required());l.value=((x=d.data)==null?void 0:x.name)??"",c.value=((p=d.data)==null?void 0:p.fetchContent)??!1,(async()=>{var o;await U(),(o=f.value)==null||o.focus()})();const r=$(()=>{var o;m({id:(o=d.data)==null?void 0:o.id,name:l.value,fetchContent:c.value})});return k(()=>{V()}),(o,n)=>{var u;return C(),g("md-dialog",null,[t("div",Ge,i(o.$t("update_subscription")),1),t("div",Se,[t("div",Be,i((u=M.data)==null?void 0:u.url),1),t("div",ze,[N(t("md-outlined-text-field",{ref_key:"inputRef",ref:f,class:"form-control",label:o.$t("name"),error:e(v),"error-text":e(v)?o.$t(e(v)):"","onUpdate:modelValue":n[0]||(n[0]=_=>H(l)?l.value=_:null),onKeyup:n[1]||(n[1]=J((..._)=>e(r)&&e(r)(..._),["enter"]))},null,40,Ke),[[j,e(l)]])]),t("div",Oe,[t("label",Pe,[t("md-checkbox",{"touch-target":"wrapper",onChange:b,checked:c.value},null,40,Ue),q(" "+i(o.$t("fetch_content_automatically")),1)])])]),t("div",je,[t("md-outlined-button",{value:"cancel",onClick:n[2]||(n[2]=(..._)=>e(V)&&e(V)(..._))},i(o.$t("cancel")),1),t("md-filled-button",{value:"save",disabled:e(F),onClick:n[3]||(n[3]=(..._)=>e(r)&&e(r)(..._)),autofocus:""},i(o.$t("save")),9,He)])])}}}),We={class:"page-container"},Ye={class:"sidebar"},Xe={class:"nav-title"},Ze={style:{position:"relative"}},et=t("md-ripple",null,null,-1),tt=["open"],ot=["onClick"],nt={slot:"headline"},st={class:"nav"},at=["onClick"],lt=["onClick","onContextmenu"],it={class:"main"},_t=I({__name:"FeedsRootView",setup(M){const{t:d}=re(),$=ue(),f=y([]),c=[{text:"add_subscription",click:x},{text:"import_opml_file",click:_},{text:"export_opml_file",click:X}],b=y(!1),m=pe(),F=_e(m.query),k=fe(m.query),l=y(),{refetch:v}=me({handle:(s,a)=>{a?T(d(a),"error"):s&&(f.value=s.feeds)},document:be,appApi:!0});function r(s){const a=s.target.files;if(!a)return;const A=new FileReader;A.addEventListener("load",()=>{n({content:A.result})},!1),A.readAsText(a[0])}function x(){R(Te,{done:()=>{v()}})}const{mutate:p,onDone:o}=D({document:ke,appApi:!0});o(s=>{ve(s.data.exportFeeds,"application/xml","feeds.xml")});const{mutate:n,onDone:u}=D({document:Ce,appApi:!0});u(()=>{T(d("imported")),v()});function _(){l.value.value="",l.value.click()}function X(){p()}function Z(s){const a=ge([{name:"feed",op:"",value:K(s.name)}]);E($,`/feeds?q=${ye(a)}`)}function ee(s,a){s.preventDefault(),Fe({x:s.x,y:s.y,items:[{label:d("edit"),onClick:()=>{R(Je,{data:a})}},{label:d("delete"),onClick:()=>{R(we,{id:a.id,name:a.name,gql:xe,appApi:!0,typeName:"Feed",done:()=>{E($,"/feeds")}})}}]})}function te(){E($,"/feeds")}return(s,a)=>{const A=ae,oe=le,ne=he("router-view"),se=$e("tooltip");return C(),g("div",We,[w(e(Me),null,{default:L(()=>[w(e(O),{size:"20","min-size":"10"},{default:L(()=>[t("div",Ye,[t("h2",Xe,[q(i(s.$t("page_title.feeds"))+" ",1),t("div",Ze,[N((C(),g("button",{class:"icon-button",id:"add-feed-ref",onClick:a[0]||(a[0]=()=>b.value=!0)},[et,w(A)])),[[se,e(d)("add_subscription")]]),t("md-menu",{anchor:"add-feed-ref",positioning:"fixed","stay-open-on-focusout":"",quick:"",open:b.value,onClosed:a[1]||(a[1]=()=>b.value=!1)},[(C(),g(G,null,S(c,h=>t("md-menu-item",{onClick:h.click},[t("div",nt,i(s.$t(h.text)),1)],8,ot)),64))],40,tt)])]),t("ul",st,[t("li",{onClick:B(te,["prevent"]),class:z({active:e(m).path==="/feeds"&&!e(F)&&!e(k)})},i(s.$t("all")),11,at),(C(!0),g(G,null,S(f.value,h=>(C(),g("li",{onClick:B(Q=>Z(h),["stop","prevent"]),onContextmenu:Q=>ee(Q,h),class:z({active:e(m).params.feedId===h.id||e(k)&&e(K)(h.name)===e(k)})},i(h.name),43,lt))),256))]),w(oe,{type:"FEED_ENTRY",selected:e(F)},null,8,["selected"])])]),_:1}),w(e(O),null,{default:L(()=>[t("div",it,[w(ne)])]),_:1})]),_:1}),t("input",{ref_key:"fileInput",ref:l,style:{display:"none"},accept:".xml",type:"file",onChange:r},null,544)])}}});export{_t as default};

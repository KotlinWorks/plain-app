import{d as K,u as W,r as b,f as X,s as q,br as P,i as Q,aC as Z,R as H,c as a,a as l,p as V,m as Y,l as F,k as i,h as m,t as r,j as o,F as w,J as ee,al as te,bh as se,o as n,I as oe,bi as ae,bj as ne,ax as le,Z as ce,z as ie,$ as re,A as de,B as ue,bl as pe,bn as R,ah as S,bo as g,aI as _e,am as he,bq as me,_ as ke}from"./index-ab4fbcdc.js";import{_ as ve}from"./Breadcrumb-f5834659.js";const be=p=>(de("data-v-061a6299"),p=p(),ue(),p),we={class:"v-toolbar"},ge={class:"right-actions"},ye=["onClick"],fe=be(()=>l("md-ripple",null,null,-1)),Ie={class:"form-check-label"},Ce=["checked"],De={class:"panel-container"},Te={key:0,class:"file-items"},Ve=["onClick","onDblclick","onContextmenu"],Fe=["checked"],Re=["src"],Se={class:"title"},Ee={style:{"font-size":"0.75rem"}},xe={key:1,class:"no-data-placeholder"},$e={key:0,class:"file-item-info"},Ae=K({__name:"FilesRecentView",setup(p){const{t:k}=W(),E=b([]),u=b(!1),y=X(),{app:f,urlTokenKey:_}=q(y),{loading:x,files:d}=P(_),{downloadFile:I,downloadDir:$,downloadFiles:A}=te(_),{view:C}=me(E,(e,t)=>{y.lightbox={sources:e,index:t,visible:!0}}),h=b(null),{mutate:N,onDone:B}=Q({document:se,appApi:!0});B(e=>{A(e.data.setTempValue.key),d.value.forEach(t=>{t.checked=!1})});const D=()=>{const e=[];return d.value.forEach(t=>{t.checked&&e.push({path:t.path})}),e};function z(e){u.value=e.target.checked}const M=()=>{N({key:pe(),value:JSON.stringify(D())})},L=Z(()=>D().length>0);function O(e){if(u.value){e.checked=!e.checked;return}h.value=e}function U(e){R(e.name)?window.open(S(_.value,e.path),"_blank"):g(e.name)?C(d.value,e):I(e.path)}function G(e,t){e.preventDefault();let c;t.isDir?c=[{label:k("download"),onClick:()=>{$(t.path)}}]:(c=[],(R(t.name)||g(t.name))&&c.push({label:k("open"),onClick:()=>{g(t.name)?C(d.value,t):window.open(S(_.value,t.path),"_blank")}}),c.push({label:k("download"),onClick:()=>{I(t.path)}})),_e({x:e.x,y:e.y,items:c})}return(e,t)=>{const c=ve,j=he,J=H("tooltip");return n(),a(w,null,[l("div",we,[V(c,{current:e.$t("recent_files")},null,8,["current"]),l("div",ge,[u.value&&L.value?Y((n(),a("button",{key:0,class:"icon-button",onClick:F(M,["stop"])},[fe,V(j)],8,ye)),[[J,e.$t("download")]]):i("",!0),l("label",Ie,[l("md-checkbox",{"touch-target":"wrapper",onChange:z,checked:u.value},null,40,Ce),m(r(e.$t("select_mode")),1)])])]),l("div",De,[o(f).permissions.includes("WRITE_EXTERNAL_STORAGE")?(n(),a("div",Te,[(n(!0),a(w,null,ee(o(d),s=>{var T;return n(),a("div",{key:s.path,class:oe(["file-item",{active:((T=h.value)==null?void 0:T.path)===s.path}]),onClick:v=>O(s),onDblclick:F(v=>U(s),["prevent"]),onContextmenu:v=>G(v,s)},[u.value?(n(),a("md-checkbox",{key:0,"touch-target":"wrapper",checked:s.checked},null,8,Fe)):i("",!0),o(ae)(s.name)||o(ne)(s.name)?(n(),a("img",{key:1,src:o(le)(s.fileId,"&w=50&h=50"),width:"50",height:"50",onerror:"this.src='/broken-image.png'"},null,8,Re)):i("",!0),l("div",Se,[m(r(s.name)+" ",1),l("div",Ee,[m(r(o(ce)(s.updatedAt)),1),s.isDir?i("",!0):(n(),a(w,{key:0},[m(", "+r(o(ie)(s.size)),1)],64))])])],42,Ve)}),128))])):i("",!0),o(d).length===0?(n(),a("div",xe,r(e.$t(o(re)(o(x),o(f).permissions,"WRITE_EXTERNAL_STORAGE"))),1)):i("",!0)]),h.value?(n(),a("div",$e,r(e.$t("path"))+": "+r(h.value.path),1)):i("",!0)],64)}}});const ze=ke(Ae,[["__scopeId","data-v-061a6299"]]);export{ze as default};

import{_ as ee}from"./MonacoEditor.vuevuetypescriptsetuptruelang-5abd4a54.js";import{_ as te}from"./print-outline-rounded-8b94114a.js";import{aK as ne,aL as O,aM as ae,d as se,a as oe,u as ie,p as re,r as C,s as ue,c as le,aA as ce,i as K,a1 as de,aN as _e,H as me,I as V,J as pe,K as fe,e as N,f as I,x as k,y as $,F as ve,A as ge,L as j,w as P,j as W,h as E,aO as he,G as Te,k as X,aP as ye,aQ as ke,aR as be,o as M,g as we,t as z,M as Me,au as xe,av as Ce,U as Ne,X as Ee,Y as Ie,$ as Le,Z as Se,_ as Ae}from"./index-0e0a27ad.js";import{_ as Ve}from"./Breadcrumb-094dc27c.js";import{g as J,M as $e}from"./splitpanes.es-72256618.js";import{u as De}from"./markdown-e0c45217.js";var Re=function(){return ne.Date.now()};const B=Re;var Ue="Expected a function",He=Math.max,Qe=Math.min;function We(g,l,i){var m,r,n,o,a,d,h=0,L=!1,p=!1,b=!0;if(typeof g!="function")throw new TypeError(Ue);l=O(l)||0,ae(i)&&(L=!!i.leading,p="maxWait"in i,n=p?He(O(i.maxWait)||0,l):n,b="trailing"in i?!!i.trailing:b);function c(t){var u=m,v=r;return m=r=void 0,h=t,o=g.apply(v,u),o}function R(t){return h=t,a=setTimeout(f,l),L?c(t):o}function S(t){var u=t-d,v=t-h,e=l-u;return p?Qe(e,n-v):e}function A(t){var u=t-d,v=t-h;return d===void 0||u>=l||u<0||p&&v>=n}function f(){var t=B();if(A(t))return w(t);a=setTimeout(f,S(t))}function w(t){return a=void 0,b&&m?c(t):(m=r=void 0,o)}function U(){a!==void 0&&clearTimeout(a),h=0,m=d=r=a=void 0}function H(){return a===void 0?o:w(B())}function x(){var t=B(),u=A(t);if(m=arguments,r=this,d=t,u){if(a===void 0)return R(d);if(p)return clearTimeout(a),a=setTimeout(f,l),c(d)}return a===void 0&&(a=setTimeout(f,l)),o}return x.cancel=U,x.flush=H,x}const Y=g=>(xe("data-v-0bf0c8d3"),g=g(),Ce(),g),Be={class:"page-container"},Fe={class:"main"},Ge={class:"v-toolbar"},Oe=["onClick"],Ke=Y(()=>I("md-ripple",null,null,-1)),je=["onClick"],Pe=Y(()=>I("md-ripple",null,null,-1)),Xe=["innerHTML"],D="NOTE",ze=se({__name:"NoteEditView",setup(g){const l=oe(),{t:i}=ie(),m=re(),r=C(m.params.id),n=C(),o=C(""),a=C(""),{app:d,urlTokenKey:h}=ue(le()),L=ce(()=>{var e;return(e=n.value)!=null&&e.deletedAt?["/notes","/notes/trash"]:["/notes"]}),{render:p}=De(d,h);let b=!1;function c(){return r.value==="create"}const R=We(()=>{U({id:c()?"":r.value,input:{content:o.value,title:he(o.value,{length:100,omission:""})}})},500),S=()=>{Te(o,async e=>{a.value=await p(e),R()})},A=()=>{window.print()},f=C();K({handle:(e,s)=>{s?X(i(s),"error"):e&&(f.value=e.tags)},document:ye,variables:{type:D},appApi:!0});let w=()=>{};if(c())S();else{const{refetch:e}=K({handle:async(s,_)=>{if(_)X(i(_),"error");else{if(n.value=s.note,b)return;o.value=s.note.content,a.value=await p(o.value),b=!0,S()}},document:ke,variables:()=>({id:r.value}),appApi:!0});w=e}const{mutate:U,onDone:H}=de({document:be,appApi:!0});H(e=>{var _,T;n.value=e.data.saveNote,c()&&((_=n.value)!=null&&_.id)&&(r.value=(T=n.value)==null?void 0:T.id,_e(l,`/notes/${r.value}`))});function x(){var s;const e=(s=n==null?void 0:n.value)==null?void 0:s.updatedAt;return e?`(${i("updated_at")}: ${Ne(e)})`:""}function t(){var e,s;Ee(Ie,{type:D,tags:f.value,item:{key:(e=n.value)==null?void 0:e.id,title:"",size:0},selected:(s=f.value)==null?void 0:s.filter(_=>{var T;return(T=n.value)==null?void 0:T.tags.some(Q=>Q.id===_.id)})})}const u=e=>{e.type===D&&w()},v=e=>{e.type===D&&w()};return me(()=>{V.on("item_tags_updated",v),V.on("items_tags_updated",u)}),pe(()=>{V.off("item_tags_updated",v),V.off("items_tags_updated",u)}),(e,s)=>{var G;const _=Le,T=Ve,Q=Se,Z=te,q=ee,F=fe("tooltip");return M(),N("div",Be,[I("div",Fe,[I("div",Ge,[k(T,{paths:L.value},{current:$(()=>{var y;return[we(z(c()?E(i)("create"):E(i)("edit"))+" ",1),(y=n.value)!=null&&y.updatedAt?(M(),Me(_,{key:0,class:"time",id:x(),raw:n.value},null,8,["id","raw"])):W("",!0)]}),_:1},8,["paths"]),(M(!0),N(ve,null,ge((G=n.value)==null?void 0:G.tags,y=>(M(),N("span",{key:y.id,class:"badge"},z(y.name),1))),128)),c()?W("",!0):j((M(),N("button",{key:0,class:"icon-button",onClick:P(t,["prevent"]),style:{"margin-inline-start":"8px"}},[Ke,k(Q)],8,Oe)),[[F,e.$t("add_to_tags")]]),c()?W("",!0):j((M(),N("button",{key:1,class:"icon-button",onClick:P(A,["prevent"])},[Pe,k(Z)],8,je)),[[F,e.$t("print")]])]),k(E($e),{class:"panel-container"},{default:$(()=>[k(E(J),null,{default:$(()=>[k(q,{language:"html",modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=y=>o.value=y)},null,8,["modelValue"])]),_:1}),k(E(J),null,{default:$(()=>[I("div",{class:"md-container",innerHTML:a.value},null,8,Xe)]),_:1})]),_:1})])])}}});const nt=Ae(ze,[["__scopeId","data-v-0bf0c8d3"]]);export{nt as default};

import{_ as z}from"./MonacoEditor.vuevuetypescriptsetuptruelang-9b86c7c4.js";import{aM as J,aN as F,aO as Y,d as Z,a as q,u as ee,p as te,r as w,s as ae,c as ne,aA as se,i as G,a1 as ie,aP as oe,H as re,I as ue,J as le,e as S,f as $,x as b,y as A,F as de,A as ce,K as me,w as fe,j as O,h as N,aQ as _e,G as pe,k as U,aR as ve,aS as ge,aT as he,o as E,g as Te,t as j,L as ye,au as ke,av as be,T as xe,W as we,X as Ne,Y as L,$ as Ee,Z as Me,_ as Ce}from"./index-5dfa21ef.js";import{_ as Ie}from"./Breadcrumb-99dc37b3.js";import{g as K,M as Se}from"./splitpanes.es-1537f4f0.js";import{u as Ae}from"./markdown-fe32200a.js";var Le=function(){return J.Date.now()};const Q=Le;var Ve="Expected a function",$e=Math.max,De=Math.min;function Re(v,l,o){var f,r,a,i,s,d,g=0,M=!1,_=!1,y=!0;if(typeof v!="function")throw new TypeError(Ve);l=F(l)||0,Y(o)&&(M=!!o.leading,_="maxWait"in o,a=_?$e(F(o.maxWait)||0,l):a,y="trailing"in o?!!o.trailing:y);function c(t){var u=f,e=r;return f=r=void 0,g=t,i=v.apply(e,u),i}function D(t){return g=t,s=setTimeout(p,l),M?c(t):i}function C(t){var u=t-d,e=t-g,n=l-u;return _?De(n,a-e):n}function k(t){var u=t-d,e=t-g;return d===void 0||u>=l||u<0||_&&e>=a}function p(){var t=Q();if(k(t))return I(t);s=setTimeout(p,C(t))}function I(t){return s=void 0,y&&f?c(t):(f=r=void 0,i)}function R(){s!==void 0&&clearTimeout(s),g=0,f=d=r=s=void 0}function W(){return s===void 0?i:I(Q())}function x(){var t=Q(),u=k(t);if(f=arguments,r=this,d=t,u){if(s===void 0)return D(d);if(_)return clearTimeout(s),s=setTimeout(p,l),c(d)}return s===void 0&&(s=setTimeout(p,l)),i}return x.cancel=R,x.flush=W,x}const We=v=>(ke("data-v-f6d301b6"),v=v(),be(),v),He={class:"page-container"},Qe={class:"main"},Be={class:"v-toolbar"},Fe=["onClick"],Ge=We(()=>$("md-ripple",null,null,-1)),Oe=["innerHTML"],V="NOTE",Ue=Z({__name:"NoteEditView",setup(v){const l=q(),{t:o}=ee(),f=te(),r=w(f.params.id),a=w(),i=w(""),s=w(""),{app:d,urlTokenKey:g}=ae(ne()),M=se(()=>{var e;return(e=a.value)!=null&&e.deletedAt?["/notes","/notes/trash"]:["/notes"]}),{render:_}=Ae(d,g);let y=!1;function c(){return r.value==="create"}const D=Re(()=>{I({id:c()?"":r.value,input:{content:i.value,title:_e(i.value,{length:100,omission:""})}})},500),C=()=>{pe(i,async e=>{s.value=await _(e),D()})},k=w();G({handle:(e,n)=>{n?U(o(n),"error"):e&&(k.value=e.tags)},document:ve,variables:{type:V},appApi:!0});let p=()=>{};if(c())C();else{const{refetch:e}=G({handle:async(n,m)=>{if(m)U(o(m),"error");else{if(a.value=n.note,y)return;i.value=n.note.content,s.value=await _(i.value),y=!0,C()}},document:ge,variables:()=>({id:r.value}),appApi:!0});p=e}const{mutate:I,onDone:R}=ie({document:he,appApi:!0});R(e=>{var m,h;a.value=e.data.saveNote,c()&&((m=a.value)!=null&&m.id)&&(r.value=(h=a.value)==null?void 0:h.id,oe(l,`/notes/${r.value}`))});function W(){var n;const e=(n=a==null?void 0:a.value)==null?void 0:n.updatedAt;return e?`(${o("updated_at")}: ${xe(e)})`:""}function x(){var e,n;we(Ne,{type:V,tags:k.value,item:{key:(e=a.value)==null?void 0:e.id,title:"",size:0},selected:(n=k.value)==null?void 0:n.filter(m=>{var h;return(h=a.value)==null?void 0:h.tags.some(H=>H.id===m.id)})})}const t=e=>{e.type===V&&p()},u=e=>{e.type===V&&p()};return re(()=>{L.on("item_tags_updated",u),L.on("items_tags_updated",t)}),ue(()=>{L.off("item_tags_updated",u),L.off("items_tags_updated",t)}),(e,n)=>{var B;const m=Ee,h=Ie,H=Me,P=z,X=le("tooltip");return E(),S("div",He,[$("div",Qe,[$("div",Be,[b(h,{paths:M.value},{current:A(()=>{var T;return[Te(j(c()?N(o)("create"):N(o)("edit"))+" ",1),(T=a.value)!=null&&T.updatedAt?(E(),ye(m,{key:0,class:"time",id:W(),raw:a.value},null,8,["id","raw"])):O("",!0)]}),_:1},8,["paths"]),(E(!0),S(de,null,ce((B=a.value)==null?void 0:B.tags,T=>(E(),S("span",{key:T.id,class:"badge"},j(T.name),1))),128)),c()?O("",!0):me((E(),S("button",{key:0,class:"icon-button",onClick:fe(x,["prevent"]),style:{"margin-inline-start":"8px"}},[Ge,b(H)],8,Fe)),[[X,e.$t("add_to_tags")]])]),b(N(Se),{class:"panel-container"},{default:A(()=>[b(N(K),null,{default:A(()=>[b(P,{language:"html",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=T=>i.value=T)},null,8,["modelValue"])]),_:1}),b(N(K),null,{default:A(()=>[$("div",{class:"md-container",innerHTML:s.value},null,8,Oe)]),_:1})]),_:1})])])}}});const Je=Ce(Ue,[["__scopeId","data-v-f6d301b6"]]);export{Je as default};

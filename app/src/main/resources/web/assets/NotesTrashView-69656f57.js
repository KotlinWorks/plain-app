import{b as le,u as ce,_ as ie,a as re}from"./list-3f4b71c4.js";import{o as n,c as l,e as t,d as de,p as ue,r as p,u as _e,C as pe,n as he,D as me,H as fe,J as ve,K as ge,L as H,M as ke,a3 as ye,N as $e,x as r,j as a,F as y,O as h,w as d,l as C,y as be,g as c,A as Z,T as qe,aS as Ce,B as z,U as E,E as Te,G as we,t as F,aQ as Ve,aT as De,P as Ne,z as Se,S as O,V as Ae,W as Be,m as Ie,X as Me,a7 as Qe,a8 as Le,a9 as Ue,$ as Ge}from"./index-df35a132.js";import{_ as He}from"./Breadcrumb-120bdd32.js";import{n as Ze}from"./list-6498ebd9.js";import{u as ze}from"./tags-ecacebdb.js";import"./vee-validate.esm-aa1410cb.js";const Ee={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Fe=t("path",{fill:"currentColor",d:"M7 21q-.825 0-1.413-.588T5 19V6q-.425 0-.713-.288T4 5q0-.425.288-.713T5 4h4q0-.425.288-.713T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5q0 .425-.288.713T19 6v13q0 .825-.588 1.413T17 21H7ZM7 6v13h10V6H7Zm0 0v13V6Zm4 5.85V15q0 .425.288.713T12 16q.425 0 .713-.288T13 15v-3.15l.9.875q.3.275.713.263t.687-.288q.275-.275.275-.7t-.275-.7l-2.6-2.6q-.275-.275-.7-.275t-.7.275l-2.6 2.6q-.275.275-.275.7t.275.7q.275.275.688.288t.712-.263l.9-.875Z"},null,-1),Oe=[Fe];function Re(R,$){return n(),l("svg",Ee,Oe)}const Ke={name:"material-symbols-restore-from-trash-outline-rounded",render:Re},Pe={class:"v-toolbar"},je=["onClick"],xe={class:"filters"},Je=["label"],We={class:"form-label"},Xe={type:"filter"},Ye=["label","selected","onClick"],et={class:"buttons"},tt=["onClick"],ot={class:"table-responsive"},st={class:"table"},nt=["checked"],at=t("th",null,"ID",-1),lt=t("th",null,null,-1),ct=["onClick"],it=["checked"],rt=["onClick"],dt={class:"nowrap"},ut={class:"action-btns"},_t=["onClick"],pt=["onClick"],ht={class:"nowrap"},mt={class:"nowrap"},ft={key:0},vt={colspan:"6"},gt={class:"no-data-placeholder"},kt={name:"NotesTrash",inheritAttrs:!1,customOptions:{}},Vt=de({...kt,setup(R){var Q,L;const $=ue(),u=p([]),T=p(),{t:w}=_e(),i=pe({text:"",tags:[]}),V="NOTE",D=he().query,m=p(parseInt(((Q=D.page)==null?void 0:Q.toString())??"1")),f=50,v=p(0),_=p(me(((L=D.q)==null?void 0:L.toString())??"")),N=p(""),{tags:K}=ze(V,_,i,async e=>{e.push({name:"trash",op:"",value:"true"}),N.value=Te(e),await we(),J()}),{deleteItems:S}=le(Ce,()=>{b()},u),{selectAll:P,toggleSelect:A,checked:j}=ce(u),{loading:x,load:J,refetch:b}=fe({handle:(e,s)=>{s?F(w(s),"error"):e&&(u.value=e.notes.map(q=>({...q,checked:!1})),v.value=e.noteCount)},document:Ve,variables:()=>({offset:(m.value-1)*f,limit:f,query:N.value}),appApi:!0});ve(m,e=>{z($,`/notes/trash?page=${e}&q=${E(_.value)}`)});function W(e){i.tags.includes(e)?Ae(i.tags,s=>s.id===e.id):i.tags.push(e)}function X(){_.value=Be(i),B(),T.value.dismiss()}function B(){z($,`/notes/trash?q=${E(_.value)}`)}const I=e=>{e===V&&b()};ge(()=>{H.on("refetch_by_tag_type",I)}),ke(()=>{H.off("refetch_by_tag_type",I)});const{mutate:M,onDone:Y}=ye({document:De,appApi:!0});function ee(){const e=u.value.filter(s=>s.checked);if(e.length===0){F(w("select_first"),"error");return}M({ids:e.map(s=>s.id)})}function te(e){Ie.push(`/notes/${e.id}`)}Y(()=>{b()});function oe(e){Me(Le,{id:e.id,name:e.id,gql:Qe`
      mutation DeleteNote($id: ID!) {
        deleteNotes(ids: [$id])
      }
    `,appApi:!0,typeName:"Note"})}return(e,s)=>{const q=He,U=Ue,G=Ke,se=ie,ne=Ge,ae=re,g=$e("tooltip");return n(),l(y,null,[t("div",Pe,[r(q,{current:()=>`${e.$t("page_title.trash")} (${v.value})`},null,8,["current"]),a(j)?(n(),l(y,{key:0},[h((n(),l("md-icon-button",{onClick:s[0]||(s[0]=d((...o)=>a(S)&&a(S)(...o),["stop"]))},[r(U)])),[[g,e.$t("delete")]]),h((n(),l("md-icon-button",{onClick:d(ee,["stop"])},[r(G)],8,je)),[[g,e.$t("restore")]])],64)):C("",!0),r(se,{ref_key:"searchInputRef",ref:T,modelValue:_.value,"onUpdate:modelValue":s[2]||(s[2]=o=>_.value=o),search:B},{filters:be(()=>[t("div",xe,[h(t("md-outlined-text-field",{label:e.$t("keywords"),"onUpdate:modelValue":s[1]||(s[1]=o=>i.text=o),"keyup.enter":"applyAndDoSearch"},null,8,Je),[[Ne,i.text]]),t("label",We,c(e.$t("tags")),1),t("md-chip-set",Xe,[(n(!0),l(y,null,Z(a(K),o=>(n(),l("md-filter-chip",{key:o.id,label:o.name,selected:i.tags.includes(o),onClick:k=>W(o)},null,8,Ye))),128))]),t("div",et,[t("md-filled-button",{onClick:d(X,["stop"])},c(e.$t("search")),9,tt)])])]),_:1},8,["modelValue"])]),t("div",ot,[t("table",st,[t("thead",null,[t("tr",null,[t("th",null,[t("md-checkbox",{"touch-target":"wrapper",onChange:s[3]||(s[3]=(...o)=>a(A)&&a(A)(...o)),checked:a(P)},null,40,nt)]),at,t("th",null,c(e.$t("title")),1),lt,t("th",null,c(e.$t("updated_at")),1),t("th",null,c(e.$t("created_at")),1)])]),t("tbody",null,[(n(!0),l(y,null,Z(u.value,o=>(n(),l("tr",{key:o.id,class:Se({selected:o.checked}),onClick:d(k=>o.checked=!o.checked,["stop"])},[t("td",null,[t("md-checkbox",{"touch-target":"wrapper",checked:o.checked},null,8,it)]),t("td",null,[r(ne,{id:o.id,raw:o},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:d(k=>te(o),["prevent"])},c(o.title||e.$t("no_content")),9,rt)]),t("td",dt,[t("div",ut,[h((n(),l("md-icon-button",{onClick:d(k=>oe(o),["stop"])},[r(U)],8,_t)),[[g,e.$t("delete")]]),h((n(),l("md-icon-button",{onClick:d(k=>a(M)({ids:[o.id]}),["stop"])},[r(G)],8,pt)),[[g,e.$t("restore")]])])]),t("td",ht,c(a(O)(o.updatedAt)),1),t("td",mt,c(a(O)(o.createdAt)),1)],10,ct))),128))]),u.value.length?C("",!0):(n(),l("tfoot",ft,[t("tr",null,[t("td",vt,[t("div",gt,c(e.$t(a(Ze)(a(x)))),1)])])]))])]),v.value>f?(n(),qe(ae,{key:0,modelValue:m.value,"onUpdate:modelValue":s[4]||(s[4]=o=>m.value=o),total:v.value,limit:f},null,8,["modelValue","total"])):C("",!0)],64)}}});export{Vt as default};

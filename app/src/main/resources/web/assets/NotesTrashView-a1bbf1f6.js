import{b as tt,u as et,_ as st,a as ot}from"./list-99d4982b.js";import{_ as nt}from"./FieldId-e37ba71f.js";import{_ as at}from"./Multiselect-346d4eab.js";import{_ as lt}from"./Breadcrumb-731a6814.js";import{d as ct,p as ut,r as p,u as rt,B as dt,G as it,n as pt,C as _t,H as ht,J as mt,K as ft,L as vt,Y as bt,o as l,c as u,b as t,e as b,g as a,F as k,w as _,f as n,k as V,x as kt,M as w,P as M,Q as gt,z as K,T as yt,aJ as $t,A as L,U as G,a9 as Vt,aa as wt,D as Ct,E as St,t as x,aH as Nt,aK as Tt,N as Dt,O as It,y as At,S as z,V as Qt,m as Ut,_ as qt}from"./index-66bea2e9.js";import{n as Bt}from"./list-6498ebd9.js";import{u as Mt}from"./tags-4fd68896.js";import"./VModal.vuevuetypescriptsetuptruelang-091ab08d.js";import"./vee-validate.esm-18b68f3d.js";const Kt=h=>(Vt("data-v-b4771bad"),h=h(),wt(),h),Lt={class:"v-toolbar"},Gt={class:"right-actions"},xt=["onClick"],zt={class:"row mb-3"},Et={class:"col-md-3 col-form-label"},Ft={class:"col-md-9"},Ot=["onKeyup"],Ht={class:"row mb-3"},Jt={class:"col-md-3 col-form-label"},Pt={class:"col-md-9"},Rt={class:"actions"},Yt=["onClick"],jt={class:"table"},Wt=Kt(()=>t("th",null,"ID",-1)),Xt=["onClick"],Zt=["onUpdate:modelValue"],te=["onClick"],ee={class:"badge"},se={class:"nowrap"},oe={class:"nowrap"},ne={key:0},ae={colspan:"6"},le={class:"no-data-placeholder"},ce={name:"NotesTrash",inheritAttrs:!1,customOptions:{}},ue=ct({...ce,setup(h){var q,B;const C=ut(),c=p([]),{t:S}=rt(),r=dt({text:"",tags:[]}),E=it(()=>c.value.some(e=>e.checked)),N="NOTE",T=pt().query,m=p(parseInt(((q=T.page)==null?void 0:q.toString())??"1")),f=50,v=p(0),d=p(_t(((B=T.q)==null?void 0:B.toString())??"")),D=p(""),{tags:F}=Mt(N,d,r,async e=>{e.push({name:"trash",op:"",value:"true"}),D.value=Ct(e),await St(),H()}),{deleteItems:I}=tt($t,()=>{y()},c),{selectAll:g,toggleSelect:A}=et(c),{loading:O,load:H,refetch:y}=ht({handle:(e,o)=>{o?x(S(o),"error"):e&&(c.value=e.notes.map($=>({...$,checked:!1})),v.value=e.noteCount)},document:Nt,variables:()=>({offset:(m.value-1)*f,limit:f,query:D.value}),appApi:!0});mt(m,e=>{L(C,`/notes/trash?page=${e}&q=${G(d.value)}`)});function Q(){d.value=Qt(r),U()}function U(){L(C,`/notes/trash?q=${G(d.value)}`)}ft(()=>{vt.on("refetch_by_tag_type",e=>{e===N&&y()})});const{mutate:J,onDone:P}=bt({document:Tt,appApi:!0});function R(){const e=c.value.filter(o=>o.checked);if(e.length===0){x(S("select_first"),"error");return}J({ids:e.map(o=>o.id)})}function Y(e){Ut.push(`/notes/${e.id}`)}return P(()=>{y()}),(e,o)=>{const $=lt,j=at,W=st,X=nt,Z=ot;return l(),u(k,null,[t("div",Lt,[b($,{current:()=>`${e.$t("page_title.trash")} (${v.value})`},null,8,["current"]),t("div",Gt,[a(E)?(l(),u(k,{key:0},[t("button",{class:"btn btn-restore",type:"button",onClick:_(R,["prevent"])},n(e.$t("restore")),9,xt),t("button",{class:"btn btn-delete",type:"button",onClick:o[0]||(o[0]=_((...s)=>a(I)&&a(I)(...s),["prevent"]))},n(e.$t("delete")),1)],64)):V("",!0),b(W,{modelValue:d.value,"onUpdate:modelValue":o[3]||(o[3]=s=>d.value=s),search:U},{filters:kt(()=>[t("div",zt,[t("label",Et,n(e.$t("keywords")),1),t("div",Ft,[w(t("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=s=>r.text=s),class:"form-control",onKeyup:It(Q,["enter"])},null,40,Ot),[[Dt,r.text]])])]),t("div",Ht,[t("label",Jt,n(e.$t("tags")),1),t("div",Pt,[b(j,{modelValue:r.tags,"onUpdate:modelValue":o[2]||(o[2]=s=>r.tags=s),label:"name","track-by":"id",options:a(F)},null,8,["modelValue","options"])])]),t("div",Rt,[t("button",{type:"button",class:"btn",onClick:_(Q,["stop"])},n(e.$t("search")),9,Yt)])]),_:1},8,["modelValue"])])]),t("table",jt,[t("thead",null,[t("tr",null,[t("th",null,[w(t("input",{class:"form-check-input",type:"checkbox",onChange:o[4]||(o[4]=(...s)=>a(A)&&a(A)(...s)),"onUpdate:modelValue":o[5]||(o[5]=s=>gt(g)?g.value=s:null)},null,544),[[M,a(g)]])]),Wt,t("th",null,n(e.$t("title")),1),t("th",null,n(e.$t("tags")),1),t("th",null,n(e.$t("updated_at")),1),t("th",null,n(e.$t("created_at")),1)])]),t("tbody",null,[(l(!0),u(k,null,K(c.value,s=>(l(),u("tr",{key:s.id,class:At({checked:s.checked}),onClick:_(i=>s.checked=!s.checked,["stop"])},[t("td",null,[w(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i=>s.checked=i},null,8,Zt),[[M,s.checked]])]),t("td",null,[b(X,{id:s.id,raw:s},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:_(i=>Y(s),["stop"])},n(s.title||e.$t("no_content")),9,te)]),t("td",null,[(l(!0),u(k,null,K(s.tags,i=>(l(),u("span",ee,n(i.name),1))),256))]),t("td",se,n(a(z)(s.updatedAt)),1),t("td",oe,n(a(z)(s.createdAt)),1)],10,Xt))),128))]),c.value.length?V("",!0):(l(),u("tfoot",ne,[t("tr",null,[t("td",ae,[t("div",le,n(e.$t(a(Bt)(a(O)))),1)])])]))]),v.value>f?(l(),yt(Z,{key:0,modelValue:m.value,"onUpdate:modelValue":o[6]||(o[6]=s=>m.value=s),total:v.value,limit:f},null,8,["modelValue","total"])):V("",!0)],64)}}});const ke=qt(ue,[["__scopeId","data-v-b4771bad"]]);export{ke as default};

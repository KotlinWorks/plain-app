import{D as de,c as ue,u as _e,_ as pe,a as he,b as me}from"./list-052a81ba.js";import{o as n,e as a,f as e,d as fe,a as ve,r as f,u as ke,B as ge,p as be,C as $e,G as ye,I as qe,a2 as Ce,L as Te,x as r,k as s,F as b,M as v,w as d,m as C,y as we,j as c,A as Z,R as Ve,aU as De,n as z,S as E,D as Ae,E as Ne,t as F,aR as Se,aV as Ie,N as Be,z as Me,Q as j,T as Qe,U as Le,aT as Re,V as Ue,a6 as Ge,a7 as Ze,a8 as ze,Y as Ee}from"./index-5e3ce573.js";import{_ as Fe}from"./Breadcrumb-db3f2c63.js";import{n as je}from"./list-6498ebd9.js";import{u as He}from"./tags-25ba5c36.js";import"./vee-validate.esm-e8a787ff.js";const Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},xe=e("path",{fill:"currentColor",d:"M7 21q-.825 0-1.413-.588T5 19V6q-.425 0-.713-.288T4 5q0-.425.288-.713T5 4h4q0-.425.288-.713T10 3h4q.425 0 .713.288T15 4h4q.425 0 .713.288T20 5q0 .425-.288.713T19 6v13q0 .825-.588 1.413T17 21H7ZM7 6v13h10V6H7Zm0 0v13V6Zm4 5.85V15q0 .425.288.713T12 16q.425 0 .713-.288T13 15v-3.15l.9.875q.3.275.713.263t.687-.288q.275-.275.275-.7t-.275-.7l-2.6-2.6q-.275-.275-.7-.275t-.7.275l-2.6 2.6q-.275.275-.275.7t.275.7q.275.275.688.288t.712-.263l.9-.875Z"},null,-1),Ke=[xe];function Pe(H,$){return n(),a("svg",Oe,Ke)}const Ye={name:"material-symbols-restore-from-trash-outline-rounded",render:Pe},Je={class:"v-toolbar"},We=e("md-ripple",null,null,-1),Xe=["onClick"],et=e("md-ripple",null,null,-1),tt={class:"filters"},ot=["label"],st={class:"form-label"},lt={type:"filter"},nt=["label","selected","onClick"],at={class:"buttons"},ct=["onClick"],it={class:"table-responsive"},rt={class:"table"},dt=["checked","indeterminate"],ut=e("th",null,"ID",-1),_t=e("th",null,null,-1),pt=["onClick"],ht=["checked"],mt=["onClick"],ft={class:"nowrap"},vt={class:"action-btns"},kt=["onClick"],gt=e("md-ripple",null,null,-1),bt=["onClick"],$t=e("md-ripple",null,null,-1),yt={class:"nowrap"},qt={class:"nowrap"},Ct={key:0},Tt={colspan:"6"},wt={class:"no-data-placeholder"},Vt={name:"NotesTrash",inheritAttrs:!1,customOptions:{}},Qt=fe({...Vt,setup(H){var L,R;const $=ve(),u=f([]),T=f(),{t:w}=ke(),i=ge({text:"",tags:[]}),O=de.NOTE,V=be().query,k=f(parseInt(((L=V.page)==null?void 0:L.toString())??"1")),m=50,_=f($e(((R=V.q)==null?void 0:R.toString())??"")),y=f(""),{tags:x}=He(O,_,i,async t=>{t.push({name:"trash",op:"",value:"true"}),y.value=Ae(t),await Ne(),X()}),{deleteItems:K}=ue(De,()=>{B()},u),{allChecked:D,realAllChecked:A,selectRealAll:P,allCheckedAlertVisible:Y,clearSelection:J,toggleAllChecked:N,toggleItemChecked:S,total:p,checked:I}=_e(u),{loading:W,load:X,refetch:B}=ye({handle:(t,l)=>{l?F(w(l),"error"):t&&(u.value=t.notes.map(q=>({...q,checked:!1})),p.value=t.noteCount)},document:Se,variables:()=>({offset:(k.value-1)*m,limit:m,query:y.value}),appApi:!0});qe(k,t=>{z($,`/notes/trash?page=${t}&q=${E(_.value)}`)});function ee(t){i.tags.includes(t)?Qe(i.tags,l=>l.id===t.id):i.tags.push(t)}function te(){_.value=Le(i),M(),T.value.dismiss()}function M(){z($,`/notes/trash?q=${E(_.value)}`)}const{mutate:Q,onDone:oe}=Ce({document:Ie,appApi:!0});function se(){const t=u.value.filter(l=>l.checked);if(t.length===0){F(w("select_first"),"error");return}Q({query:`ids:${t.map(l=>l.id).join(",")}`})}function le(t){Re.push(`/notes/${t.id}`)}oe(()=>{B()});function ne(t){Ue(Ze,{id:t.id,name:t.id,gql:Ge`
      mutation DeleteNote($query: String!) {
        deleteNotes(query: $query)
      }
    `,variables:()=>({query:`ids:${t.id}`}),done:()=>{p.value--},appApi:!0,typeName:"Note"})}return(t,l)=>{const q=Fe,U=ze,G=Ye,ae=pe,ce=he,ie=Ee,re=me,g=Te("tooltip");return n(),a(b,null,[e("div",Je,[r(q,{current:()=>`${t.$t("page_title.trash")} (${s(p)})`},null,8,["current"]),s(I)?(n(),a(b,{key:0},[v((n(),a("button",{class:"icon-button",onClick:l[0]||(l[0]=d(o=>s(K)(s(A),y.value),["stop"]))},[We,r(U)])),[[g,t.$t("delete")]]),v((n(),a("button",{class:"icon-button",onClick:d(se,["stop"])},[et,r(G)],8,Xe)),[[g,t.$t("restore")]])],64)):C("",!0),r(ae,{ref_key:"searchInputRef",ref:T,modelValue:_.value,"onUpdate:modelValue":l[2]||(l[2]=o=>_.value=o),search:M},{filters:we(()=>[e("div",tt,[v(e("md-outlined-text-field",{label:t.$t("keywords"),"onUpdate:modelValue":l[1]||(l[1]=o=>i.text=o),"keyup.enter":"applyAndDoSearch"},null,8,ot),[[Be,i.text]]),e("label",st,c(t.$t("tags")),1),e("md-chip-set",lt,[(n(!0),a(b,null,Z(s(x),o=>(n(),a("md-filter-chip",{key:o.id,label:o.name,selected:i.tags.includes(o),onClick:h=>ee(o)},null,8,nt))),128))]),e("div",at,[e("md-filled-button",{onClick:d(te,["stop"])},c(t.$t("search")),9,ct)])])]),_:1},8,["modelValue"])]),r(ce,{limit:m,total:s(p),"all-checked-alert-visible":s(Y),"real-all-checked":s(A),"select-real-all":s(P),"clear-selection":s(J)},null,8,["total","all-checked-alert-visible","real-all-checked","select-real-all","clear-selection"]),e("div",it,[e("table",rt,[e("thead",null,[e("tr",null,[e("th",null,[e("md-checkbox",{"touch-target":"wrapper",onChange:l[3]||(l[3]=(...o)=>s(N)&&s(N)(...o)),checked:s(D),indeterminate:!s(D)&&s(I)},null,40,dt)]),ut,e("th",null,c(t.$t("title")),1),_t,e("th",null,c(t.$t("updated_at")),1),e("th",null,c(t.$t("created_at")),1)])]),e("tbody",null,[(n(!0),a(b,null,Z(u.value,o=>(n(),a("tr",{key:o.id,class:Me({selected:o.checked}),onClick:d(h=>o.checked=!o.checked,["stop"])},[e("td",null,[e("md-checkbox",{"touch-target":"wrapper",onChange:l[4]||(l[4]=(...h)=>s(S)&&s(S)(...h)),checked:o.checked},null,40,ht)]),e("td",null,[r(ie,{id:o.id,raw:o},null,8,["id","raw"])]),e("td",null,[e("a",{href:"#",onClick:d(h=>le(o),["prevent"])},c(o.title||t.$t("no_content")),9,mt)]),e("td",ft,[e("div",vt,[v((n(),a("button",{class:"icon-button",onClick:d(h=>ne(o),["stop"])},[gt,r(U)],8,kt)),[[g,t.$t("delete")]]),v((n(),a("button",{class:"icon-button",onClick:d(h=>s(Q)({query:`ids:${o.id}`}),["stop"])},[$t,r(G)],8,bt)),[[g,t.$t("restore")]])])]),e("td",yt,c(s(j)(o.updatedAt)),1),e("td",qt,c(s(j)(o.createdAt)),1)],10,pt))),128))]),u.value.length?C("",!0):(n(),a("tfoot",Ct,[e("tr",null,[e("td",Tt,[e("div",wt,c(t.$t(s(je)(s(W)))),1)])])]))])]),s(p)>m?(n(),Ve(re,{key:0,modelValue:k.value,"onUpdate:modelValue":l[5]||(l[5]=o=>k.value=o),total:s(p),limit:m},null,8,["modelValue","total"])):C("",!0)],64)}}});export{Qt as default};

import{u as st,_ as nt,a as at}from"./list-2a0eb093.js";import{_ as lt}from"./FieldId-d3cd765c.js";import{_ as ct}from"./Multiselect-22bdf84a.js";import{_ as it}from"./Dropdown.vuevuetypescriptsetuptruelang-615229ff.js";import{_ as rt}from"./Breadcrumb-49d3fe3b.js";import{d as ut,p as dt,r as _,u as pt,A as _t,n as mt,B as ht,C as ft,D as vt,t as M,az as gt,G as kt,U as bt,aA as yt,H as $t,I as wt,o as c,c as u,b as t,e as m,w as k,f as n,v as Vt,J as w,K as Ct,L as Tt,g as a,M as Q,N as At,F as V,y as I,x as St,P as F,k as K,Q as Dt,z as L,R as x,m as z}from"./index-03d179e2.js";import{b as Nt,a as Ut}from"./search-fae66e3e.js";import{n as qt}from"./list-6498ebd9.js";import{u as Bt,a as Mt,b as Qt}from"./tags-01c5b779.js";import"./VModal.vuevuetypescriptsetuptruelang-33c2fc8e.js";import"./baseIndexOf-70b929c6.js";import"./vee-validate.esm-16aa8390.js";const It={class:"v-toolbar"},Ft={class:"right-actions"},Kt=["onClick"],Lt={class:"row mb-3"},xt={class:"col-md-3 col-form-label"},zt={class:"col-md-9"},Rt=["onKeyup"],Gt={class:"row mb-3"},Et={class:"col-md-3 col-form-label"},Pt={class:"col-md-9"},Ht={class:"actions"},Jt=["onClick"],Ot={class:"table"},jt=t("th",null,"ID",-1),Wt=["onClick"],Xt=["onUpdate:modelValue"],Yt=["onClick"],Zt={class:"badge"},te={class:"nowrap"},ee={class:"nowrap"},oe={key:0},se={colspan:"6"},ne={class:"no-data-placeholder"},ke=ut({__name:"NotesView",setup(ae){var q,B;const C=dt(),l=_([]),{t:d}=pt(),i=_t({text:"",tags:[]}),h="NOTE",T=mt().query,f=_(parseInt(((q=T.page)==null?void 0:q.toString())??"1")),v=50,g=_(0),r=_(ht(((B=T.q)==null?void 0:B.toString())??"")),A=_(""),{tags:b}=Bt(h,r,i,async e=>{e.push({name:"trash",op:"",value:"false"}),A.value=Nt(e),await ft(),H()}),{addToTags:R}=Mt(h,l,b),{removeFromTags:G}=Qt(h,l,b),E=[{text:d("add_to_tags"),click:R},{text:d("remove_from_tags"),click:G},{text:d("move_to_trash"),click:j}],{selectAll:y,toggleSelect:S}=st(l),{loading:P,load:H,refetch:D}=vt({handle:(e,s)=>{s?M(d(s),"error"):e&&(l.value=e.notes.map($=>({...$,checked:!1})),g.value=e.noteCount)},document:gt,variables:()=>({offset:(f.value-1)*v,limit:v,query:A.value}),appApi:!0});kt(f,e=>{L(C,`/notes?page=${e}&q=${x(r.value)}`)});const{mutate:J,onDone:O}=bt({document:yt,appApi:!0});function j(){const e=l.value.filter(s=>s.checked);if(e.length===0){M(d("select_first"),"error");return}J({ids:e.map(s=>s.id)})}O(()=>{D()});function N(){r.value=Ut(i),U()}function U(){L(C,`/notes?q=${x(r.value)}`)}$t(()=>{wt.on("refetch_by_tag_type",e=>{e===h&&D()})});function W(e){z.push(`/notes/${e.id}`)}function X(){z.push("/notes/create")}return(e,s)=>{const $=rt,Y=it,Z=ct,tt=nt,et=lt,ot=at;return c(),u(V,null,[t("div",It,[m($,{current:()=>`${e.$t("page_title.notes")} (${g.value})`},null,8,["current"]),t("div",Ft,[t("button",{class:"btn btn-action",type:"button",onClick:k(X,["prevent"])},n(e.$t("create")),9,Kt),m(Y,{title:e.$t("actions"),items:E},null,8,["title"]),m(tt,{modelValue:r.value,"onUpdate:modelValue":s[2]||(s[2]=o=>r.value=o),search:U},{filters:Vt(()=>[t("div",Lt,[t("label",xt,n(e.$t("keywords")),1),t("div",zt,[w(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=o=>i.text=o),class:"form-control",onKeyup:Tt(N,["enter"])},null,40,Rt),[[Ct,i.text]])])]),t("div",Gt,[t("label",Et,n(e.$t("tags")),1),t("div",Pt,[m(Z,{modelValue:i.tags,"onUpdate:modelValue":s[1]||(s[1]=o=>i.tags=o),label:"name","track-by":"id",options:a(b)},null,8,["modelValue","options"])])]),t("div",Ht,[t("button",{type:"button",class:"btn",onClick:k(N,["stop"])},n(e.$t("search")),9,Jt)])]),_:1},8,["modelValue"])])]),t("table",Ot,[t("thead",null,[t("tr",null,[t("th",null,[w(t("input",{class:"form-check-input",type:"checkbox",onChange:s[3]||(s[3]=(...o)=>a(S)&&a(S)(...o)),"onUpdate:modelValue":s[4]||(s[4]=o=>At(y)?y.value=o:null)},null,544),[[Q,a(y)]])]),jt,t("th",null,n(e.$t("title")),1),t("th",null,n(e.$t("tags")),1),t("th",null,n(e.$t("updated_at")),1),t("th",null,n(e.$t("created_at")),1)])]),t("tbody",null,[(c(!0),u(V,null,I(l.value,o=>(c(),u("tr",{key:o.id,class:St({checked:o.checked}),onClick:k(p=>o.checked=!o.checked,["stop"])},[t("td",null,[w(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":p=>o.checked=p},null,8,Xt),[[Q,o.checked]])]),t("td",null,[m(et,{id:o.id,raw:o},null,8,["id","raw"])]),t("td",null,[t("a",{href:"#",onClick:k(p=>W(o),["stop"])},n(o.title||e.$t("no_content")),9,Yt)]),t("td",null,[(c(!0),u(V,null,I(o.tags,p=>(c(),u("span",Zt,n(p.name),1))),256))]),t("td",te,n(a(F)(o.updatedAt)),1),t("td",ee,n(a(F)(o.createdAt)),1)],10,Wt))),128))]),l.value.length?K("",!0):(c(),u("tfoot",oe,[t("tr",null,[t("td",se,[t("div",ne,n(e.$t(a(qt)(a(P)))),1)])])]))]),g.value>v?(c(),Dt(ot,{key:0,modelValue:f.value,"onUpdate:modelValue":s[5]||(s[5]=o=>f.value=o),total:g.value,limit:v},null,8,["modelValue","total"])):K("",!0)],64)}}});export{ke as default};

import{o,c as r,a as t,d as P,u as W,r as v,i as $,O as J,P as g,Q as K,g as X,x as y,R as Y,p as q,F as ee,m as b,j as s,k as h,t as m,h as te,aW as ne,bu as se,bv as oe,bw as re,bx as ae,A as ie,B as ce,_ as le}from"./index-ab4fbcdc.js";import{_ as ue}from"./refresh-rounded-0bd469e7.js";import{_ as de}from"./Breadcrumb-f5834659.js";const _e={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},pe=t("path",{fill:"currentColor",d:"M6 19q-.425 0-.713-.288T5 18v-3q0-.425.288-.713T6 14q.425 0 .713.288T7 15v2h2q.425 0 .713.288T10 18q0 .425-.288.713T9 19H6Zm0-9q-.425 0-.713-.288T5 9V6q0-.425.288-.713T6 5h3q.425 0 .713.288T10 6q0 .425-.288.713T9 7H7v2q0 .425-.288.713T6 10Zm9 9q-.425 0-.713-.288T14 18q0-.425.288-.713T15 17h2v-2q0-.425.288-.713T18 14q.425 0 .713.288T19 15v3q0 .425-.288.713T18 19h-3Zm3-9q-.425 0-.713-.288T17 9V7h-2q-.425 0-.713-.288T14 6q0-.425.288-.713T15 5h3q.425 0 .713.288T19 6v3q0 .425-.288.713T18 10Z"},null,-1),ve=[pe];function me(l,u){return o(),r("svg",_e,ve)}const he={name:"material-symbols-fullscreen-rounded",render:me},fe="/assets/screen-mirror-permission-e9e07af8.png",ge={xmlns:"http://www.w3.org/2000/svg",viewBox:"176.31 -11.19 346.88 581.88"},qe=t("path",{d:"M470.49 0H229.51a41.901 41.901 0 0 0-29.547 12.277 41.898 41.898 0 0 0-12.277 29.547v476.35a41.901 41.901 0 0 0 12.277 29.547 41.898 41.898 0 0 0 29.547 12.277h240.98a41.901 41.901 0 0 0 29.547-12.277 41.898 41.898 0 0 0 12.277-29.547V41.824a41.901 41.901 0 0 0-12.277-29.547A41.898 41.898 0 0 0 470.49 0zm33.25 518.18a33.334 33.334 0 0 1-9.766 23.484 33.335 33.335 0 0 1-23.484 9.766H229.51a33.334 33.334 0 0 1-23.484-9.766 33.335 33.335 0 0 1-9.765-23.484V41.83a33.333 33.333 0 0 1 9.828-23.371 33.32 33.32 0 0 1 23.422-9.703h240.98a33.334 33.334 0 0 1 23.484 9.765 33.335 33.335 0 0 1 9.765 23.484z"},null,-1),be=t("path",{d:"M317.62 46.812h64.75c2.418 0 4.375-1.957 4.375-4.375s-1.957-4.375-4.375-4.375h-64.75c-2.418 0-4.375 1.957-4.375 4.375s1.957 4.375 4.375 4.375zM364.7 192.5a16.8 16.8 0 0 0-14.7-8.75 16.8 16.8 0 0 0-14.698 8.75l-91 157.5a16.453 16.453 0 0 0 0 16.977 16.584 16.584 0 0 0 6.101 6.386 16.653 16.653 0 0 0 8.512 2.364h182.09a16.626 16.626 0 0 0 14.7-8.75 16.803 16.803 0 0 0 0-16.977zm83.562 170.36a8.224 8.224 0 0 1-7.262 4.2H258.91a8.229 8.229 0 0 1-7.176-4.2 8.753 8.753 0 0 1 0-8.75l91-157.5a8.748 8.748 0 0 1 7.262-4.113 8.757 8.757 0 0 1 7.262 4.199l91 157.5a8.75 8.75 0 0 1 0 8.84z"},null,-1),Se=t("path",{d:"M350 221.55a4.288 4.288 0 0 0-4.29 4.285v66.238a4.375 4.375 0 0 0 8.75 0v-66.238a4.286 4.286 0 0 0-4.46-4.285zm0 91.26a4.289 4.289 0 0 0-4.29 4.29v17.061a4.375 4.375 0 0 0 8.75 0V317.1a4.286 4.286 0 0 0-4.46-4.29z"},null,-1),Te=[qe,be,Se];function ke(l,u){return o(),r("svg",ge,Te)}const we={render:ke},S=l=>(ie("data-v-df9e2f57"),l=l(),ce(),l),$e={class:"page-container"},ye={class:"main"},Me={class:"v-toolbar"},Ie=S(()=>t("md-ripple",null,null,-1)),Ce=["disabled"],Ve=S(()=>t("md-ripple",null,null,-1)),Ae={key:0,class:"loading"},Le=S(()=>t("md-circular-progress",{indeterminate:""},null,-1)),Re=[Le],ze={key:1,class:"request-permission"},De=S(()=>t("img",{src:fe},null,-1)),He={class:"text"},Be={key:2,class:"request-permission-failed"},Qe=P({__name:"ScreenMirrorView",setup(l){let u;const{t:T}=W(),a=v(!1),d=v(0),_=v(!1),p=v(!1),M=v(),I=v(),C=async e=>{a.value=!0,H(e),_.value=!1,d.value=0,clearInterval(u)};let i=!1;const{mutate:R}=$({document:se,appApi:!0}),z=()=>{p.value=!p.value,p.value||A()},D=()=>{R(),i=!0},V=e=>{e&&i&&(i=!1,clearInterval(u),k())};function H(e){const n=I.value;if(!n||p.value)return;const f=n.getContext("2d"),c=new Image;c.src=URL.createObjectURL(e),c.onload=function(){f&&(n.width=c.width,n.height=c.height,f.drawImage(c,0,0))}}J(()=>{g.on("screen_mirroring",C),g.on("app_socket_connection_changed",V)}),K(()=>{g.off("screen_mirroring",C),g.off("app_socket_connection_changed",V)});const{mutate:B,loading:Q,onDone:x,onError:E}=$({document:oe,appApi:!0}),{loading:F,refetch:A}=X({handle:(e,n)=>{n?y(T(n),"error"):e.screenMirrorState?a.value=!0:(a.value=!1,k())},document:re,appApi:!0}),G=()=>{var e;(e=M.value)==null||e.requestFullscreen({navigationUI:"show"})},k=()=>{_.value=!1,B()};E(e=>{y(T(e.message)),_.value=!0}),x(()=>{d.value=30,u=setInterval(()=>{d.value--,d.value<=0&&(_.value=!0,clearInterval(u))},1e3)});const{mutate:L,loading:N,onDone:U,onError:Z}=$({document:ae,appApi:!0});return Z(e=>{y(T(e.message))}),U(()=>{_.value=!0,a.value=!1}),(e,n)=>{const f=de,c=ue,j=he,w=Y("tooltip");return o(),r("div",$e,[t("div",ye,[t("div",Me,[q(f,{current:()=>e.$t("screen_mirror")},null,8,["current"]),a.value?(o(),r(ee,{key:0},[p.value?h("",!0):b((o(),r("button",{key:0,class:"icon-button",onClick:n[0]||(n[0]=()=>s(A)())},[Ie,q(c)])),[[w,e.$t("refresh")]]),t("md-outlined-button",{onClick:z,class:"btn-sm"},m(e.$t(p.value?"resume":"pause")),1),b((o(),r("md-outlined-button",{disabled:s(N),onClick:n[1]||(n[1]=(...O)=>s(L)&&s(L)(...O)),class:"btn-sm"},[te(m(e.$t("stop_mirror")),1)],8,Ce)),[[w,e.$t("stop_mirror")]]),b((o(),r("button",{class:"icon-button",onClick:G},[Ve,q(j)])),[[w,e.$t("fullscreen")]])],64)):s(i)?h("",!0):(o(),r("md-outlined-button",{key:1,onClick:D},m(e.$t("relaunch_app")),1))]),t("div",{ref_key:"containerRef",ref:M,class:"panel-container"},[s(F)||s(Q)||s(i)?(o(),r("div",Ae,Re)):h("",!0),d.value>0&&!s(i)?(o(),r("div",ze,[De,t("pre",He,m(e.$t("screen_mirror_request_permission",{seconds:d.value})),1)])):h("",!0),_.value&&!a.value&&!s(i)?(o(),r("div",Be,[q(s(we)),t("p",null,m(e.$t("screen_mirror_request_permission_failed")),1),t("md-filled-button",{onClick:k},m(e.$t("try_again")),1)])):h("",!0),b(t("canvas",{ref_key:"canvasRef",ref:I,class:"canvas"},null,512),[[ne,a.value]])],512)])])}}});const Ge=le(Qe,[["__scopeId","data-v-df9e2f57"]]);export{Ge as default};

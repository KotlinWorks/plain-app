import{o as d,c as l,e as p,d as V,u as w,p as B,r as L,i as Q,t as A,aM as E,K as G,L as o,M as N,N as S,f as F,g as m,O as H,w as y,x as I,F as v,A as z,z as U,j,bC as b,X as u,a3 as C,bD as K,E as O,B as P,bE as X,U as Z,bF as J,bG as R,a8 as W}from"./index-df35a132.js";import{c as Y}from"./index-4e369b28.js";import{E as q}from"./EditValueModal-46b4c4bb.js";const ee={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},te=p("path",{fill:"currentColor",d:"M12 19q-.425 0-.713-.288T11 18v-5H6q-.425 0-.713-.288T5 12q0-.425.288-.713T6 11h5V6q0-.425.288-.713T12 5q.425 0 .713.288T13 6v5h5q.425 0 .713.288T19 12q0 .425-.288.713T18 13h-5v5q0 .425-.288.713T12 19Z"},null,-1),ae=[te];function ne(c,a){return d(),l("svg",ee,ae)}const se={name:"material-symbols-add-rounded",render:ne},oe={class:"nav-title mt-4"},ie=["onClick"],re={class:"nav"},de=["onClick","onContextmenu"],ue=V({__name:"TagFilter",props:{tagType:{type:String,required:!0},selected:{type:String,required:!0}},setup(c){const a=c,{t:n}=w(),k=B(),_=L([]),{refetch:i}=Q({handle:(e,t)=>{t?A(n(t),"error"):e&&(_.value=e.tags)},document:E,variables:{type:a.tagType},appApi:!0});function x(){u(q,{title:n("add_tag"),placeholder:n("name"),mutation:()=>C({document:K,options:{update:()=>{i()}},appApi:!0}),getVariables:e=>({type:a.tagType,name:e})})}function M(e){const t=O([{name:"tag",op:"",value:b(e.name)}]);P(k,`/${X[a.tagType]}?q=${Z(t)}`)}function $(e,t){e.preventDefault(),Y({x:e.x,y:e.y,items:[{label:n("rename"),onClick:()=>{u(q,{title:n("rename"),placeholder:n("name"),value:t.name,mutation:()=>C({document:J,appApi:!0}),getVariables:r=>({id:t.id,name:r}),done:()=>{i()}})}},{label:n("delete"),onClick:()=>{u(W,{id:t.id,name:t.name,gql:R,appApi:!0,typeName:"Tag"})}}]})}const g=e=>{e===a.tagType&&i()},f=e=>{e.items.some(r=>r.tags.length)&&e.tagType===a.tagType&&i()},h=e=>{e.item.tags.length&&e.tagType===a.tagType&&i()};return G(()=>{o.on("refetch_tags",g),o.on("media_items_deleted",f),o.on("media_item_deleted",h)}),N(()=>{o.off("refetch_tags",g),o.off("media_items_deleted",f),o.off("media_item_deleted",h)}),(e,t)=>{const r=se,D=S("tooltip");return d(),l(v,null,[p("h2",oe,[F(m(e.$t("tags"))+" ",1),H((d(),l("md-icon-button",{onClick:y(x,["prevent"])},[I(r)],8,ie)),[[D,e.$t("add_tag")]])]),p("ul",re,[(d(!0),l(v,null,z(_.value,s=>(d(),l("li",{onClick:y(T=>M(s),["prevent"]),key:s.id,onContextmenu:T=>$(T,s),class:U({active:c.selected&&j(b)(s.name)===c.selected})},m(s.name)+" ("+m(s.count)+") ",43,de))),128))])],64)}}});export{ue as _,se as a};

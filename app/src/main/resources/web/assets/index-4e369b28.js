import{d as B,bJ as q,r as p,J as H,K as L,bK as U,v as Q,o as w,c as P,O as $,by as D,e as S,F as X,A as Y,bI as E,T as F,j as s,l as O,z as ee,av as ne,aw as te,_ as oe,br as se,bL as j}from"./index-df35a132.js";const K=t=>(ne("data-v-efd8d0c2"),t=t(),te(),t),le=K(()=>S("span",{class:"right-arrow"},null,-1)),ae=[le],ie=K(()=>S("span",{class:"right-arrow"},null,-1)),ue=[ie],de=["disabled","onMouseenter","onFocus","onClick","headline"],ce=B({__name:"ContextSubMenu",props:{items:{type:Object,default:null},parentItem:{type:Object,default:null},options:{type:Object,default:null},zIndex:{type:Number,default:0},globalData:{type:Object,default:null},position:{type:Object,default:null}},emits:["close","keepOpen","preUpdatePos"],setup(t,{emit:o}){const f=t,{globalData:i,position:u,options:v,parentItem:l}=q(f),h=p(),y=p(),d=p(!1),C=p(!1);let x=null;const M=p(0),c=p(null),g=p({parentPosition:{x:0,y:0},screenSize:i.value.screenSize}),b=p({x:0,y:0});function W(n,e){if(e.disabled||!e.children||e.children.length==0||c.value===e)return;c.value=e,g.value.parentPosition.x=i.value.parentPosition.x+u.value.x,g.value.parentPosition.y=i.value.parentPosition.y+u.value.y,h.value&&(b.value.x=h.value.offsetWidth+(v.value.xOffset||0));const r=n.target;r&&(b.value.y=r.offsetTop+(v.value.yOffset||0))}function z(){x=c.value,setTimeout(()=>{x===c.value&&(c.value=null)})}H(c,(n,e)=>{n&&e&&setTimeout(()=>{y.value&&y.value.doCheckPos()},50)});function N(n){z(),n&&o("close",!0)}function R(n){x===n&&(x=null),o("keepOpen",l.value)}function J(n){b.value.x=n.x,b.value.y=n.y}function V(n){n.disabled||(typeof n.onClick=="function"?(n.onClick(),o("close",!0)):(!n.children||n.children.length===0)&&o("close",!0))}function Z(){o("keepOpen",l.value)}function A(n){n.relatedTarget!=null&&o("close",!1)}function T(n){h.value&&(h.value.scrollTop+=n?30:-30)}let k=0;function G(){const n=h.value,e=i.value;if(n){const r={x:u.value.x,y:u.value.y},a=e.parentPosition.x+u.value.x+n.offsetWidth;if(a>e.screenSize.w&&(r.x-=a-e.screenSize.w),n.offsetHeight>e.screenSize.h-30)M.value=e.screenSize.h-30,r.y=-e.parentPosition.y,C.value=!0;else{C.value=!1,M.value=0;const I=e.parentPosition.y+u.value.y+n.offsetHeight;I>e.screenSize.h&&(r.y-=I-e.screenSize.h+30)}o("preUpdatePos",r),d.value=!0}}return L(()=>{k=window.setTimeout(()=>G(),100)}),U(()=>{k>0&&(clearTimeout(k),k=0)}),(n,e)=>{const r=Q("ContextSubMenu",!0);return t.items?(w(),P("div",{key:0,class:ee("context-menu "+(s(v).customClass?s(v).customClass:"")+(d.value?" ready":"")),style:E({maxWidth:s(l)&&s(l).maxWidth?`${s(l).maxWidth}px`:"600px",minWidth:s(l)&&s(l).minWidth?`${s(l).minWidth}px`:"100px",zIndex:t.zIndex,left:`${s(u).x}px`,top:`${s(u).y}px`}),onMouseenter:Z,onMouseleave:e[4]||(e[4]=a=>A(a))},[$(S("div",{class:"context-menu-updown up",onClick:e[0]||(e[0]=a=>T(!1))},ae,512),[[D,C.value]]),$(S("div",{class:"context-menu-updown down",onClick:e[1]||(e[1]=a=>T(!0))},ue,512),[[D,C.value]]),S("div",{class:"context-menu-items",ref_key:"menu",ref:h,style:E({maxHeight:M.value>0?`${M.value}px`:""})},[(w(!0),P(X,null,Y(t.items,(a,I)=>(w(),P("md-menu-item",{key:I,disabled:a.disabled,onMouseenter:m=>W(m,a),onMouseleave:e[2]||(e[2]=m=>z()),onFocus:m=>W(m,a),onBlur:e[3]||(e[3]=m=>z()),onClick:m=>V(a),headline:a.label},null,40,de))),128))],4),c.value&&c.value.children?(w(),F(r,{key:0,ref_key:"childMenu",ref:y,zIndex:t.zIndex+1,items:c.value.children,parentItem:c.value,options:s(v),globalData:g.value,position:b.value,onClose:N,onKeepOpen:R,onPreUpdatePos:J},null,8,["zIndex","items","parentItem","options","globalData","position"])):O("",!0)],38)):O("",!0)}}});const re=oe(ce,[["__scopeId","data-v-efd8d0c2"]]),_={defaultMinWidth:100,defaultMaxWidth:600,defaultStartZindex:1},pe=B({__name:"ContextMenu",props:{options:{type:Object,default:null},show:{type:Boolean,default:!1}},emits:["update:show","close"],setup(t,{emit:o}){const f=t,i=p({x:0,y:0}),u={parentPosition:{x:0,y:0},screenSize:{w:window.innerWidth,h:window.innerHeight}};function v(){i.value.x=f.options.x,i.value.y=f.options.y}function l(){o("update:show",!1),o("close")}function h(d){d&&l()}function y(d){i.value.x=d.x,i.value.y=d.y}return L(()=>{v(),setTimeout(()=>{document.addEventListener("click",l),document.addEventListener("contextmenu",l)},100)}),U(()=>{document.removeEventListener("click",l)}),H(()=>f.show,d=>{d&&v()}),(d,C)=>{const x=re;return t.show?(w(),F(x,{key:0,items:t.options.items,parentItem:{maxWidth:t.options.maxWidth||s(_).defaultMaxWidth,minWidth:t.options.minWidth||s(_).defaultMinWidth},options:t.options,"z-index":t.options.zIndex||s(_).defaultStartZindex,globalData:u,position:i.value,"on-close":h,"on-pre-update-pos":y},null,8,["items","parentItem","options","z-index","position"])):O("",!0)}}}),ve=t=>{const o=document.createElement("div"),f=se(pe,{options:t,show:!0,onClose:()=>{j(null,o)}});return j(f,o),document.body.appendChild(o.firstElementChild),f.component};export{ve as c};
